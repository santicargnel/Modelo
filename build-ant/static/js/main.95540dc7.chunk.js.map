{"version":3,"sources":["App.tsx","index.tsx"],"names":["MODS_POR_PRODUCTO","key","label","delta","productos","id","nombre","precio","initialState","seleccionados","ventaConfirmada","ventas","montoPagado","numeroVentaActual","ventasAnteriores","mensajeTicket","lugarConsumo","medioPagoActual","cierresCaja","ultimoCierreISO","pagosActuales","Efectivo","D√©bito","Cr√©dito","QR","Cuenta","pagos","modificadores","lineas","comandas","comandaEnProcesoId","MEDIOS","estadoVacioPagos","fmtAR","n","toLocaleString","minimumFractionDigits","maximumFractionDigits","nowParts","d","Date","parts","Intl","DateTimeFormat","timeZone","year","month","day","hour","minute","second","hour12","formatToParts","reduce","acc","p","type","value","yyyy","mm","dd","hh","mi","ss","fecha","concat","hora","createdAtISO","sumaPagos","s","k","Number","Boton","_ref","children","bg","color","hoverBg","hoverColor","onClick","hover","setHover","useState","_jsx","onMouseEnter","onMouseLeave","style","backgroundColor","cursor","borderRadius","padding","fontSize","fontFamily","fontWeight","border","transition","Evento14Diciembre","estado","setEstado","raw","localStorage","getItem","JSON","parse","medioGuardado","_objectSpread","Array","isArray","e","console","error","useEffect","setItem","stringify","cobroAbierto","setCobroAbierto","pagosDraft","setPagosDraft","cierreAbierto","setCierreAbierto","resumenCorte","setResumenCorte","resumenVenta","setResumenVenta","billetes","setBilletes","b100","b200","b500","b1000","b2000","b10000","b20000","cuentas","setCuentas","bica","mp","macro","denom","billeteKeys","totalEfectivoContado","totalCuentasBicaMacroContado","abrirCobro","cancelarCobro","cloneLinea","ln","uid","Math","random","toString","slice","now","productoId","mods","qty","seleccionadosFromLineas","sel","forEach","totalComanda","c","prod","find","extra","extrasDeltaUnitario","totalLinea","calcularTotal","total","linea","imprimirTicket","ventana","window","open","alert","partes","push","v","subtotal","cantidad","producto","items","filter","m","length","document","write","join","close","print","comandasAbierto","setComandasAbierto","buscaComanda","setBuscaComanda","cerrarComandas","cargarComanda","prev","x","map","obs","getModDefs","modsState","modsTexto","_Fragment","_jsxs","className","seleccionarProducto","idx","findIndex","l","Object","keys","i","defs","extraUnit","precioUnit","precioTotal","duplicarLinea","src","clon","title","eliminarLinea","pid","splice","checked","onChange","target","abs","name","placeholder","display","justifyContent","alignItems","gap","marginTop","marginBottom","width","imprimirComanda","popup","comanda","_crypto$randomUUID","_crypto","crypto","randomUUID","call","numeroSugerido","crearComandaActual","q","detalleMods","setTimeout","focus","_unused","confirmarVenta","abrirComandas","flexWrap","limpiarSeleccion","descargarRegistro","String","replace","csv","_v$mensajeTicket","numeroVenta","medioPago","a","createElement","href","encodeURIComponent","download","click","imprimirUltimoTicket","ultimasVentas","reiniciarRegistro","confirm","removeItem","abrirResumenVentas","ventasVigentes","anulada","porProducto","Map","_porProducto$get","it","get","set","baseProductos","from","entries","_ref2","porLugar","_v$lugarConsumo","_porLugar$k","baseLugares","_ref3","lugar","w","win","nf","NumberFormat","render","criterio","ps","sort","b","localeCompare","r","format","lugares","totalGeneral","csvProductos","urlCSVProductos","csvLugares","urlCSVLugar","getElementById","onchange","abrirResumenPorVenta","porVenta","grupos","_ref4","num","some","totalInclAnuladas","g","totalSoloVigentes","head","rows","etiqueta","urlCSV","abrirCierreConConteo","desdeISO","pagosPeriodo","anuladas","Set","pagosVigentes","has","totalesPorMedio","medio","monto","cantidadVentas","size","hastaISO","toISOString","trim","toLowerCase","includes","alias","confirmarComanda","eliminarComanda","_p$nombre","pp","position","inset","zIndex","stopPropagation","background","maxWidth","boxShadow","textAlign","min","step","inputMode","flex","sumatoria","diferencia","pendiente","max","vueltoUI","paddingTop","borderTop","confirmarCobro","totalPagos","otros","faltaLuegoDeNoEfectivo","efectivo","vuelto","mediosUsados","medioPagoEtiqueta","_producto$nombre","_producto$precio","productId","pagosRegistrados","nuevasComandas","gridTemplateColumns","_resumenCorte$totales2","_ref6","_billetes$k","marginRight","_ref7","_cuentas$k","dif","confirmarCierreConConteo","contadoEfvo","contadoMP","contadoCuenta","contadoTotal","esperadoTotal","difTotal","_resumenCorte$totales","cierre","every","container","createRoot","StrictMode","App"],"mappings":"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","file":"static/js/main.95540dc7.chunk.js","sourcesContent":["import { useEffect, useState } from \"react\";\n\n/* ========================= Tipos ========================= */\ntype MedioPago = \"Efectivo\" | \"D√©bito\" | \"Cr√©dito\" | \"QR\" | \"Cuenta\";\nexport type LugarConsumo = \"Retira\" | \"Delivery\" | \"Aca\";\n\n/* ==== Modificadores (definici√≥n) ==== */\ntype ModificadorKey =\n  | \"Sin Mayo\"\n  | \"Sin Lechuga\"\n  | \"Sin Tomate\"\n  | \"Sin Huevo\"\n  | \"Con Mostaza\"\n  | \"Con Ketchup\"\n  | \"Sin Queso\"\n  | \"Sin Jamon\"\n  | \"Papas c/ketchup\";\n\ntype ModificadorDef = {\n  key: ModificadorKey;\n  label: string; // C√≥mo se muestra en UI/ticket\n  delta: number; // Impacto en precio (0 si es ‚Äúsin ...‚Äù)\n};\n// üëá sum√° esto a los tipos de modificadores que ya ten√©s\ntype LineaSeleccion = {\n  uid: string;\n  productoId: number;\n  mods: Partial<Record<ModificadorKey, boolean>>;\n  qty: number; // üëà cantidad en la misma l√≠nea\n};\ntype ResumenVentaModal = {\n  numeroVenta: number;\n  ventas: Venta[];\n  pagos: Record<MedioPago, number>;\n  total: number;\n  vuelto: number;\n};\n\n/** Cat√°logo: por producto, qu√© modificadores est√°n disponibles */\nconst MODS_POR_PRODUCTO: Record<number, ModificadorDef[]> = {\n  // Hamb completa simple / doble\n  1: [\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Con Mostaza\", label: \"Con Mostaza\", delta: 0 },\n    { key: \"Con Ketchup\", label: \"Con Ketchup\", delta: 0 },\n  ],\n  2: [\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Con Mostaza\", label: \"Con Mostaza\", delta: 0 },\n    { key: \"Con Ketchup\", label: \"Con Ketchup\", delta: 0 },\n  ],\n  3: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Con Mostaza\", label: \"Con Mostaza\", delta: 0 },\n    { key: \"Con Ketchup\", label: \"Con Ketchup\", delta: 0 },\n  ],\n  4: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Con Mostaza\", label: \"Con Mostaza\", delta: 0 },\n    { key: \"Con Ketchup\", label: \"Con Ketchup\", delta: 0 },\n  ],\n  5: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Sin Huevo\", label: \"Sin Huevo\", delta: 200 },\n    { key: \"Sin Queso\", label: \"Sin Queso\", delta: -100 },\n    { key: \"Sin Jamon\", label: \"Sin Jamon\", delta: -100 },\n  ],\n  6: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Sin Huevo\", label: \"Sin Huevo\", delta: -200 },\n    { key: \"Sin Queso\", label: \"Sin Queso\", delta: -100 },\n    { key: \"Sin Jamon\", label: \"Sin Jamon\", delta: -100 },\n  ],\n  7: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Con Mostaza\", label: \"Con Mostaza\", delta: 0 },\n    { key: \"Con Ketchup\", label: \"Con Ketchup\", delta: 0 },\n  ],\n  8: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Sin Huevo\", label: \"Sin Huevo\", delta: 0 },\n    { key: \"Sin Queso\", label: \"Sin Queso\", delta: 0 },\n    { key: \"Sin Jamon\", label: \"Sin Jamon\", delta: 0 },\n  ],\n  9: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Con Mostaza\", label: \"Con Mostaza\", delta: 0 },\n    { key: \"Con Ketchup\", label: \"Con Ketchup\", delta: 0 },\n  ],\n  10: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Sin Huevo\", label: \"Sin Huevo\", delta: 0 },\n    { key: \"Sin Queso\", label: \"Sin Queso\", delta: 0 },\n    { key: \"Sin Jamon\", label: \"Sin Jamon\", delta: 0 },\n  ],\n  11: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Con Mostaza\", label: \"Con Mostaza\", delta: 0 },\n    { key: \"Con Ketchup\", label: \"Con Ketchup\", delta: 0 },\n  ],\n  12: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Sin Huevo\", label: \"Sin Huevo\", delta: 0 },\n    { key: \"Sin Queso\", label: \"Sin Queso\", delta: 0 },\n    { key: \"Sin Jamon\", label: \"Sin Jamon\", delta: 0 },\n  ],\n  13: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Con Mostaza\", label: \"Con Mostaza\", delta: 0 },\n    { key: \"Con Ketchup\", label: \"Con Ketchup\", delta: 0 },\n  ],\n  14: [\n    { key: \"Sin Lechuga\", label: \"Sin Lechuga\", delta: 0 },\n    { key: \"Sin Tomate\", label: \"Sin Tomate\", delta: 0 },\n    { key: \"Sin Mayo\", label: \"Sin Mayo\", delta: 0 },\n    { key: \"Sin Huevo\", label: \"Sin Huevo\", delta: 0 },\n    { key: \"Sin Queso\", label: \"Sin Queso\", delta: 0 },\n    { key: \"Sin Jamon\", label: \"Sin Jamon\", delta: 0 },\n  ],\n\n  // Pod√©s sumar m√°s IDs ac√° (lomito, etc.)\n};\n\nexport interface Producto {\n  id: number;\n  nombre: string;\n  precio: number;\n}\n\nexport interface Venta {\n  fecha: string; // DD-MM-YYYY\n  hora: string; // HH:mm:ss (24h)\n  createdAtISO: string; // ISO completo\n  producto: string;\n  cantidad: number;\n  precio: number; // unitario\n  numeroVenta: number;\n  mensajeTicket?: string;\n  lugarConsumo: LugarConsumo;\n  medioPago: MedioPago | \"Mixto\";\n  productId?: number;\n  mods?: Partial<Record<ModificadorKey, boolean>>;\n  anulada?: boolean;\n}\n\ninterface CierreCaja {\n  id: string; // ISO time\n  desdeISO: string;\n  hastaISO: string;\n  totalesPorMedio: Record<MedioPago, number>;\n  totalGeneral: number;\n  cantidadVentas: number;\n}\n\ninterface Pago {\n  numeroVenta: number;\n  medio: MedioPago;\n  monto: number;\n  createdAtISO: string;\n}\n\ninterface Estado {\n  seleccionados: { [id: number]: number };\n  ventaConfirmada: boolean;\n  ventas: Venta[];\n  montoPagado: number;\n  numeroVentaActual: number;\n  ventasAnteriores: Venta[];\n  mensajeTicket: string;\n  lugarConsumo: LugarConsumo;\n  medioPagoActual: MedioPago;\n  cierresCaja: CierreCaja[];\n  ultimoCierreISO: string;\n  pagosActuales: Record<MedioPago, number>;\n  pagos: Pago[];\n  modificadores: Record<number, Partial<Record<ModificadorKey, boolean>>>;\n  lineas: LineaSeleccion[];\n  comandas: Comanda[];\n  comandaEnProcesoId: string | null; // si estoy confirmando una comanda espec√≠fica\n}\ninterface Comanda {\n  id: string;\n  fecha: string;\n  hora: string;\n  createdAtISO: string;\n  numeroSugerido: number;\n  lineas: LineaSeleccion[];\n  estado: \"pendiente\" | \"cobrada\" | \"anulada\";\n  obs?: string;\n  alias?: string;\n}\n\ntype ResumenCorte = {\n  desdeISO: string;\n  hastaISO: string;\n  cantidadVentas: number;\n  totalesPorMedio: Record<MedioPago, number>;\n  totalGeneral: number;\n};\n\n/* ========================= Datos ========================= */\nconst productos: Producto[] = [\n  { id: 1, nombre: \"Hamb c/cheddar simple\", precio: 8600 },\n  { id: 2, nombre: \"Hamb c/cheddar doble\", precio: 10300 },\n  { id: 3, nombre: \"Hamb comun simple\", precio: 8600 },\n  { id: 4, nombre: \"Hamb comun doble\", precio: 10300 },\n  { id: 5, nombre: \"Hamb completa simple\", precio: 10200 },\n  { id: 6, nombre: \"Hamb completa doble\", precio: 11900 },\n  { id: 7, nombre: \"Patynesa comun\", precio: 9000 },\n  { id: 8, nombre: \"Patynesa completa\", precio: 10400 },\n  { id: 9, nombre: \"Lomito comun\", precio: 11400 },\n  { id: 10, nombre: \"Lomito completo\", precio: 12800 },\n  { id: 11, nombre: \"Mila sandwich comun\", precio: 10000 },\n  { id: 12, nombre: \"Mila sandwich completo\", precio: 11400 },\n  { id: 13, nombre: \"Suprema sand. comun\", precio: 9000 },\n  { id: 14, nombre: \"Suprema sand. completo\", precio: 10400 },\n  { id: 15, nombre: \"Tostado\", precio: 6000 },\n  { id: 16, nombre: \"Carlitos\", precio: 6000 },\n  { id: 17, nombre: \"Pizzanesa carne\", precio: 20000 },\n  { id: 18, nombre: \"Pizzanesa pollo\", precio: 18000 },\n  { id: 19, nombre: \"Milanesa al plato\", precio: 9000 },\n  { id: 20, nombre: \"Suprema al plato\", precio: 8000 },\n  { id: 21, nombre: \"Milanesa napo\", precio: 10000 },\n  { id: 22, nombre: \"Suprema napo\", precio: 9000 },\n  { id: 23, nombre: \"Milanesa picada\", precio: 9000 },\n  { id: 24, nombre: \"Suprema picada\", precio: 8000 },\n  { id: 25, nombre: \"Milanesa cheddar/grati\", precio: 10000 },\n  { id: 26, nombre: \"Suprema cheddar/grati\", precio: 9000 },\n  { id: 27, nombre: \"Milanesa a caballo\", precio: 10000 },\n  { id: 28, nombre: \"Suprema a caballo\", precio: 9000 },\n  { id: 29, nombre: \"Fritas porcion\", precio: 6000 },\n  { id: 30, nombre: \"Fritas media porcion\", precio: 4000 },\n  { id: 31, nombre: \"Fritas porcion c/cheddar\", precio: 7000 },\n  { id: 32, nombre: \"Fritas media c/cheddar\", precio: 5000 },\n  { id: 33, nombre: \"Cheddar agreg. porcion\", precio: 1800 },\n  { id: 34, nombre: \"Cheddar agreg. media\", precio: 1000 },\n  { id: 35, nombre: \"Nuggets 10un\", precio: 5000 },\n  { id: 36, nombre: \"Nuggets 10un c/cheddar\", precio: 6000 },\n  { id: 37, nombre: \"Pizza jym o napolitana\", precio: 12000 },\n  { id: 38, nombre: \"Gaseosa chica\", precio: 2500 },\n  { id: 39, nombre: \"Gaseosa 1.5l\", precio: 5000 },\n  { id: 40, nombre: \"Coca vidrio\", precio: 4500 },\n  { id: 41, nombre: \"Fernet Jarra\", precio: 8000 },\n  { id: 42, nombre: \"Agua/Sabor. chica\", precio: 2000 },\n  { id: 43, nombre: \"Agua/Sabar. grande\", precio: 3500 },\n  { id: 44, nombre: \"Cerveza Santa Fe Lata\", precio: 2500 },\n  { id: 45, nombre: \"Cerveza Santa Fe Botella\", precio: 5000 },\n  { id: 46, nombre: \"Delivery\", precio: 1500 },\n  { id: 47, nombre: \"Sin papas\", precio: -2000 },\n];\n\n/* ========================= Estado inicial ========================= */\nconst initialState: Estado = {\n  seleccionados: {},\n  ventaConfirmada: false,\n  ventas: [],\n  montoPagado: 0,\n  numeroVentaActual: 1001,\n  ventasAnteriores: [],\n  mensajeTicket: \"\",\n  lugarConsumo: \"Aca\",\n  medioPagoActual: \"Efectivo\",\n  cierresCaja: [],\n  ultimoCierreISO: \"\",\n  pagosActuales: { Efectivo: 0, D√©bito: 0, Cr√©dito: 0, QR: 0, Cuenta: 0 },\n  pagos: [],\n  modificadores: {},\n  lineas: [],\n  comandas: [],\n  comandaEnProcesoId: null,\n};\n\n/* ========================= Constantes / helpers ========================= */\nconst MEDIOS: MedioPago[] = [\"Efectivo\", \"D√©bito\", \"Cr√©dito\", \"QR\", \"Cuenta\"];\n\nconst estadoVacioPagos: Record<MedioPago, number> = {\n  Efectivo: 0,\n  D√©bito: 0,\n  Cr√©dito: 0,\n  QR: 0,\n  Cuenta: 0,\n};\n\nconst fmtAR = (n: number) =>\n  n.toLocaleString(\"es-AR\", {\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  });\n\nconst totalVentas = (vs: Venta[]) =>\n  vs.reduce((acc, v) => acc + v.precio * v.cantidad, 0);\n\n// Reemplaz√° nowParts() por esto:\nconst tz = \"America/Argentina/Cordoba\";\nconst nowParts = () => {\n  const d = new Date();\n  const fmt = new Intl.DateTimeFormat(\"es-AR\", {\n    timeZone: tz,\n    year: \"numeric\",\n    month: \"2-digit\",\n    day: \"2-digit\",\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: false,\n  });\n\n  const parts = fmt\n  .formatToParts(d)\n  .reduce((acc: Record<string, string>, p) => {\n    acc[p.type] = p.value;\n    return acc;\n  }, {});\n\n  const yyyy = parts.year,\n    mm = parts.month,\n    dd = parts.day;\n  const hh = parts.hour,\n    mi = parts.minute,\n    ss = parts.second;\n\n  return {\n    fecha: `${dd}-${mm}-${yyyy}`, // DD-MM-YYYY\n    hora: `${hh}:${mi}:${ss}`,\n    createdAtISO: `${yyyy}-${mm}-${dd}T${hh}:${mi}:${ss}-03:00`,\n  };\n}; // ‚úÖ ESTA L√çNEA FALTABA\n\nconst sumaPagos = (pagos: Record<MedioPago, number>) =>\n  MEDIOS.reduce((s, k) => s + (Number(pagos[k]) || 0), 0);\n\n// üî• BOT√ìN REUTILIZABLE CON HOVER\nconst Boton = ({\n  children,\n  bg,\n  color,\n  hoverBg,\n  hoverColor,\n  onClick\n}: {\n  children: React.ReactNode;\n  bg: string;\n  color: string;\n  hoverBg: string;\n  hoverColor: string;\n  onClick?: () => void;\n}) => {\n  const [hover, setHover] = useState(false);\n\n  return (\n    <button\n      onClick={onClick}\n      onMouseEnter={() => setHover(true)}\n      onMouseLeave={() => setHover(false)}\n      style={{\n        backgroundColor: hover ? hoverBg : bg,\n        color: hover ? hoverColor : color,\n        cursor: \"pointer\",\n        borderRadius: \"4px\",\n        padding: \"6px 14px\",\n        fontSize: \"0.9rem\",\n        fontFamily: \"Montserrat, sans-serif\",\n        fontWeight: 700,\n        border: \"none\",\n        transition: \"0.2s ease-in-out\",\n      }}\n    >\n      {children}\n    </button>\n  );\n};\n\n// ========================= Componente =========================\nconst Evento14Diciembre = () => {\n\n  // Estado principal + persistencia\n  // Estado principal + persistencia\n  // Estado principal + persistencia\n  const [estado, setEstado] = useState<Estado>(() => {\n    try {\n      const raw = localStorage.getItem(\"estado\");\n      if (raw) {\n        const s: any = JSON.parse(raw);\n\n        // Medio de pago guardado o default\n        const medioGuardado =\n          s && typeof s.medioPagoActual === \"string\"\n            ? s.medioPagoActual\n            : \"Efectivo\";\n\n        return {\n          ...initialState,\n          ...(s || {}),\n\n          // aseguramos valores v√°lidos\n          medioPagoActual: medioGuardado,\n          pagosActuales: {\n            ...estadoVacioPagos,\n            ...(s && s.pagosActuales ? s.pagosActuales : {}),\n          },\n          pagos: s && Array.isArray(s.pagos) ? s.pagos : [],\n          modificadores: (s && s.modificadores) || {},\n          lineas: s && Array.isArray(s.lineas) ? s.lineas : [],\n          comandas: s && Array.isArray(s.comandas) ? s.comandas : [],\n          comandaEnProcesoId:\n            s && typeof s.comandaEnProcesoId === \"string\"\n              ? s.comandaEnProcesoId\n              : null,\n        };\n      }\n    } catch (e) {\n      console.error(\"Error leyendo localStorage\", e);\n    }\n\n    // Fallback si no hay nada en storage o hubo error\n    return {\n      ...initialState,\n      pagosActuales: { ...estadoVacioPagos },\n      pagos: [],\n      modificadores: {},\n      lineas: [],\n      comandas: [],\n      comandaEnProcesoId: null,\n    };\n  });\n\n  useEffect(() => {\n    try {\n      localStorage.setItem(\"estado\", JSON.stringify(estado));\n    } catch (e) {\n      console.error(\"Error guardando localStorage\", e);\n    }\n  }, [estado]);\n\n  // Modales y auxiliares\n  const [cobroAbierto, setCobroAbierto] = useState(false);\n  const [pagosDraft, setPagosDraft] = useState<Record<MedioPago, number>>({\n    Efectivo: 0,\n    D√©bito: 0,\n    Cr√©dito: 0,\n    QR: 0,\n    Cuenta: 0,\n  });\n\n  const [cierreAbierto, setCierreAbierto] = useState(false);\n  const [resumenCorte, setResumenCorte] = useState<ResumenCorte | null>(null);\nconst [resumenVenta, setResumenVenta] = useState<ResumenVentaModal | null>(null);\n\n  type BilleteKey =\n    | \"b100\"\n    | \"b200\"\n    | \"b500\"\n    | \"b1000\"\n    | \"b2000\"\n    | \"b10000\"\n    | \"b20000\";\n  const [billetes, setBilletes] = useState<Record<BilleteKey, string>>({\n    b100: \"\",\n    b200: \"\",\n    b500: \"\",\n    b1000: \"\",\n    b2000: \"\",\n    b10000: \"\",\n    b20000: \"\",\n  });\n  const [cuentas, setCuentas] = useState({ bica: \"\", mp: \"\", macro: \"\" });\n\n  const denom: Record<BilleteKey, number> = {\n    b100: 100,\n    b200: 200,\n    b500: 500,\n    b1000: 1000,\n    b2000: 2000,\n    b10000: 10000,\n    b20000: 20000,\n  };\n\n  const billeteKeys: BilleteKey[] = [\n  \"b100\",\n  \"b200\",\n  \"b500\",\n  \"b1000\",\n  \"b2000\",\n  \"b10000\",\n  \"b20000\",\n];\n\nconst mediosPagoLista: MedioPago[] = [\"Efectivo\", \"D√©bito\", \"Cr√©dito\", \"QR\", \"Cuenta\"];\n\nconst billetesDefs: { k: BilleteKey; l: string }[] = [\n  { k: \"b100\", l: \"$100\" },\n  { k: \"b200\", l: \"$200\" },\n  { k: \"b500\", l: \"$500\" },\n  { k: \"b1000\", l: \"$1.000\" },\n  { k: \"b2000\", l: \"$2.000\" },\n  { k: \"b10000\", l: \"$10.000\" },\n  { k: \"b20000\", l: \"$20.000\" },\n];\nconst cuentasDefs: Array<{ k: \"bica\" | \"mp\" | \"macro\"; label: string }> = [\n  { k: \"bica\", label: \"Bica\" },\n  { k: \"mp\", label: \"MP\" },\n  { k: \"macro\", label: \"Macro\" },\n];\n\n\nconst totalEfectivoContado = () =>\n  billeteKeys.reduce((s, key) => {\n    const cantidad = Number(billetes[key] || 0);\n    const valor = denom[key] || 0;\n    return s + cantidad * valor;\n  }, 0);\n\n\n\n\n  const totalCuentasBicaMacroContado = () =>\n    Number(cuentas.bica || 0) + Number(cuentas.macro || 0);\n\n  /* ========================= L√≥gica ========================= */\n\n  const abrirCobro = () => {\n    setPagosDraft(estado.pagosActuales || { ...estadoVacioPagos });\n    setCobroAbierto(true);\n  };\n\n  const cancelarCobro = () => setCobroAbierto(false);\n\n  const confirmarCobro = () => {\n    const total = calcularTotal();\n    const pagos = pagosDraft;\n    const totalPagos = sumaPagos(pagos);\n\n    if (totalPagos <= 0) {\n      alert(\"Ingres√° al menos un monto en los medios de pago.\");\n      return;\n    }\n    if (totalPagos < total) {\n      alert(\"La suma de los medios es menor que el total.\");\n      return;\n    }\n\n    // Vuelto (solo con efectivo)\n    const otros =\n      (pagos[\"D√©bito\"] || 0) +\n      (pagos[\"Cr√©dito\"] || 0) +\n      (pagos[\"QR\"] || 0) +\n      (pagos[\"Cuenta\"] || 0);\n    const faltaLuegoDeNoEfectivo = Math.max(0, total - otros);\n    const efectivo = pagos[\"Efectivo\"] || 0;\n    const vuelto = Math.max(0, efectivo - faltaLuegoDeNoEfectivo);\n\n    // üëá Ac√° va tu l√≥gica de medios de pago\n    const mediosUsados = MEDIOS.filter((m) => (pagos[m] || 0) > 0);\n    const medioPagoEtiqueta: MedioPago | \"Mixto\" =\n      mediosUsados.length === 1 ? mediosUsados[0] : \"Mixto\";\n    const { fecha, hora, createdAtISO } = nowParts();\n    // Ahora ya pod√©s usar medioPagoEtiqueta cuando armes la venta:\n    const ventas: Venta[] = estado.lineas.map((linea) => {\n      const producto = productos.find((p) => p.id === linea.productoId);\n      const extra = extrasDeltaUnitario(linea.productoId, linea.mods);\n      const detalleMods = modsTexto(linea.productoId, linea.mods);\n      return {\n        fecha,\n        hora,\n        createdAtISO,\n        producto: producto?.nombre ?? \"\",\n        cantidad: linea.qty || 1,\n        precio: (producto?.precio ?? 0) + extra,\n        numeroVenta: estado.numeroVentaActual,\n        mensajeTicket: detalleMods || \"\",\n        lugarConsumo: estado.lugarConsumo,\n        medioPago: medioPagoEtiqueta, // üëà ac√° lo us√°s\n        productId: linea.productoId,\n        mods: { ...linea.mods },\n      };\n    });\n\n    // Registrar pagos (para cierre de caja)\n    const pagosRegistrados: Pago[] = MEDIOS.filter(\n      (m) => (pagos[m] || 0) > 0\n    ).map((m) => ({\n      numeroVenta: estado.numeroVentaActual,\n      medio: m,\n      monto: pagos[m],\n      createdAtISO,\n    }));\n\n        if (vuelto > 0) alert(`Vuelto: $${fmtAR(vuelto)}`);\n\n    // üëâ Guardamos info para el recuadro/resumen\n    setResumenVenta({\n      numeroVenta: estado.numeroVentaActual,\n      ventas,\n      pagos,\n      total,\n      vuelto,\n    });\n\n    // Ticket con desglose\n    imprimirTicket(ventas, pagos);\n\n\n    // Guardar y avanzar; cerrar modal\n    // ...dentro de confirmarCobro(), justo antes de setCobroAbierto(false):\n\n    // Guardar y avanzar; cerrar modal\n    setEstado((prev) => {\n      // üëá marcamos la comanda como \"cobrada\" si corresponde\n      let nuevasComandas = prev.comandas;\n      if (prev.comandaEnProcesoId) {\n        nuevasComandas = prev.comandas.map((c) =>\n          c.id === prev.comandaEnProcesoId ? { ...c, estado: \"cobrada\" } : c\n        );\n      }\n\n      return {\n        ...prev,\n        ventasAnteriores: [...prev.ventas],\n        ventas: [...prev.ventas, ...ventas],\n        pagos: [...prev.pagos, ...pagosRegistrados],\n        seleccionados: {},\n        lineas: [],\n        numeroVentaActual: prev.numeroVentaActual + 1,\n        mensajeTicket: \"\",\n        montoPagado: totalPagos,\n        pagosActuales: { ...estadoVacioPagos },\n        comandas: nuevasComandas,\n        comandaEnProcesoId: null,\n      };\n    });\n\n    setCobroAbierto(false);\n  };\n  const nuevaLinea = (productoId: number): LineaSeleccion => ({\n    uid: Math.random().toString(36).slice(2) + Date.now().toString(36),\n    productoId,\n    mods: {},\n    qty: 1, // üëà\n  });\n  const duplicarLinea = (uid: string) =>\n    setEstado((prev) => {\n      const src = prev.lineas.find((l) => l.uid === uid);\n      if (!src) return prev;\n\n      const clon: LineaSeleccion = {\n        uid: Math.random().toString(36).slice(2) + Date.now().toString(36),\n        productoId: src.productoId,\n        mods: { ...src.mods },\n        qty: 1, // siempre arranca en 1\n      };\n\n      const lineas = [...prev.lineas, clon];\n\n      const seleccionados = { ...prev.seleccionados };\n      seleccionados[src.productoId] = (seleccionados[src.productoId] || 0) + 1;\n\n      return { ...prev, lineas, seleccionados };\n    });\n\n  const seleccionarProducto = (id: number) =>\n    setEstado((prev) => {\n      // buscamos una l√≠nea del mismo producto SIN modificadores\n      const idx = prev.lineas.findIndex(\n        (l) => l.productoId === id && Object.keys(l.mods || {}).length === 0\n      );\n\n      let lineas: LineaSeleccion[];\n      if (idx !== -1) {\n        // si existe, solo subimos qty\n        lineas = prev.lineas.map((l, i) =>\n          i === idx ? { ...l, qty: (l.qty || 1) + 1 } : l\n        );\n      } else {\n        // si no existe, creamos nueva l√≠nea base (qty 1)\n        lineas = [...prev.lineas, nuevaLinea(id)];\n      }\n\n      const seleccionados = { ...prev.seleccionados };\n      seleccionados[id] = (seleccionados[id] || 0) + 1;\n\n      return { ...prev, lineas, seleccionados };\n    });\n\n  const eliminarLinea = (uid: string) =>\n    setEstado((prev) => {\n      const idx = prev.lineas.findIndex((l) => l.uid === uid);\n      if (idx === -1) return prev;\n      const pid = prev.lineas[idx].productoId;\n      const lineas = prev.lineas.slice();\n      lineas.splice(idx, 1);\n\n      const seleccionados = { ...prev.seleccionados };\n      if ((seleccionados[pid] || 0) > 1) seleccionados[pid]--;\n      else delete seleccionados[pid];\n\n      return { ...prev, lineas, seleccionados };\n    });\n\n  const eliminarProducto = (id: number) =>\n    setEstado((prev) => {\n      const seleccionados = { ...prev.seleccionados };\n      if (seleccionados[id] > 1) seleccionados[id]--;\n      else delete seleccionados[id];\n      return { ...prev, seleccionados };\n    });\n  // üëá clona profundo una l√≠nea (por seguridad)\n  const cloneLinea = (ln: LineaSeleccion): LineaSeleccion => ({\n    uid: Math.random().toString(36).slice(2) + Date.now().toString(36),\n    productoId: ln.productoId,\n    mods: { ...(ln.mods || {}) },\n    qty: ln.qty || 1,\n  });\n\n  // Crea un objeto Comanda a partir de las l√≠neas actuales (sin setear estado)\n  const crearComandaActual = (estado: Estado): Comanda => {\n    const { fecha, hora, createdAtISO } = nowParts();\n    // üëá Definir alias ANTES del return\n    return {\n      id:\n        crypto.randomUUID?.() ||\n        Math.random().toString(36).slice(2) + Date.now().toString(36),\n      fecha,\n      hora,\n      createdAtISO,\n      numeroSugerido: estado.numeroVentaActual,\n      lineas: estado.lineas.map(cloneLinea),\n      estado: \"pendiente\",\n      obs: estado.mensajeTicket || \"\",\n    };\n  };\n\n  // Recuenta \"seleccionados\" a partir de l√≠neas (para que el badge coincida con el carrito)\n  const seleccionadosFromLineas = (lineas: LineaSeleccion[]) => {\n    const sel: Estado[\"seleccionados\"] = {};\n    lineas.forEach((ln) => {\n      sel[ln.productoId] = (sel[ln.productoId] || 0) + (ln.qty || 1);\n    });\n    return sel;\n  };\n\n  // Total de una l√≠nea (unitario producto + extras) * qty\n  const totalLinea = (ln: LineaSeleccion) => {\n    const prod = productos.find((p) => p.id === ln.productoId);\n    if (!prod) return 0;\n    const extra = extrasDeltaUnitario(ln.productoId, ln.mods);\n    return (prod.precio + extra) * (ln.qty || 1);\n  };\n\n  // Total de una comanda\n  const totalComanda = (c: Comanda) =>\n    c.lineas.reduce((s, ln) => s + totalLinea(ln), 0);\n\n  const cancelarEdicionComanda = () => {\n    setEstado((prev) => ({\n      ...prev,\n      comandaEnProcesoId: null,\n      // si quer√©s limpiar el carrito al cancelar:\n      lineas: [],\n      seleccionados: {},\n      mensajeTicket: \"\",\n      pagosActuales: { ...estadoVacioPagos },\n    }));\n  };\n\n  // ===== ANULAR =====\nconst anularVenta = (numeroVenta: number, skipConfirm?: boolean) => {\n  if (!skipConfirm && !confirm(`¬øAnular la venta N¬∞ ${numeroVenta}?`)) return;\n\n  const { createdAtISO } = nowParts();\n  setEstado((prev) => {\n    if (ventaEstaAnulada(prev.ventas, numeroVenta)) return prev;\n\n    const pagosOriginales = prev.pagos.filter(\n      (p) => p.numeroVenta === numeroVenta\n    );\n    const ajustesNegativos: Pago[] = pagosOriginales.map((p) => ({\n      numeroVenta: p.numeroVenta,\n      medio: p.medio,\n      monto: -Math.abs(p.monto),\n      createdAtISO,\n    }));\n\n    const ventasMarcadas = prev.ventas.map((v) =>\n      v.numeroVenta === numeroVenta ? { ...v, anulada: true } : v\n    );\n\n    const ventasDelTicket = prev.ventas.filter(\n  (v) => v.numeroVenta === numeroVenta\n);\n\n// Armamos nuevasLineas sin nulls, ‚Äúa mano‚Äù\nconst nuevasLineas: LineaSeleccion[] = [];\nventasDelTicket.forEach((v) => {\n  const ln = lineaFromVenta(v);\n  if (ln) {\n    nuevasLineas.push(ln);\n  }\n});\n\n\n\n    const seleccionados = { ...prev.seleccionados };\n    nuevasLineas.forEach((ln) => {\n      seleccionados[ln.productoId] =\n        (seleccionados[ln.productoId] || 0) + (ln.qty || 1);\n    });\n\n    return {\n      ...prev,\n      ventas: ventasMarcadas,\n      pagos: [...prev.pagos, ...ajustesNegativos],\n      lineas: nuevasLineas,\n      seleccionados,\n      mensajeTicket: \"\",\n      pagosActuales: { ...estadoVacioPagos },\n    };\n  });\n};\n\n\n  // ===== REHACER (solo carga al carrito; NO toca pagos ni marca) =====\n  const rehacerVenta = (numeroVenta: number) => {\n  setEstado((prev) => {\n    const ventasDelTicket = prev.ventas.filter(\n  (v) => v.numeroVenta === numeroVenta\n);\n\n// Armamos nuevasLineas sin nulls, ‚Äúa mano‚Äù\nconst nuevasLineas: LineaSeleccion[] = [];\nventasDelTicket.forEach((v) => {\n  const ln = lineaFromVenta(v);\n  if (ln) {\n    nuevasLineas.push(ln);\n  }\n});\n\n\n    const seleccionados = { ...prev.seleccionados };\n    nuevasLineas.forEach((ln) => {\n      seleccionados[ln.productoId] =\n        (seleccionados[ln.productoId] || 0) + (ln.qty || 1);\n    });\n\n    return {\n      ...prev,\n      lineas: nuevasLineas,\n      seleccionados,\n      mensajeTicket: \"\",\n      pagosActuales: { ...estadoVacioPagos },\n    };\n  });\n};\n\n  // --- Resumen por producto ---\n  // --- Resumen por producto (excluye anuladas) ---\n  const abrirResumenVentas = () => {\n  // ‚¨áÔ∏è solo ventas vigentes\n  const ventasVigentes = estado.ventas.filter((v) => !v.anulada);\n\n  // Agrupar por producto\n  const porProducto = new Map<string, { cantidad: number; total: number }>();\n  ventasVigentes.forEach((v) => {\n    const it = porProducto.get(v.producto) ?? { cantidad: 0, total: 0 };\n    it.cantidad += v.cantidad;\n    it.total += v.cantidad * v.precio;\n    porProducto.set(v.producto, it);\n  });\n\n  const baseProductos = Array.from(porProducto.entries()).map(\n    ([producto, it]) => ({ producto, cantidad: it.cantidad, total: it.total })\n  );\n\n  // Por lugar de consumo\n  const porLugar: Record<string, number> = {};\n  ventasVigentes.forEach((v) => {\n    const k = v.lugarConsumo ?? \"N/D\";\n    porLugar[k] = (porLugar[k] ?? 0) + v.cantidad * v.precio;\n  });\n  const baseLugares = Object.entries(porLugar).map(([lugar, total]) => ({\n    lugar,\n    total,\n  }));\n\n  const w = window.open(\"\", \"ResumenVentas\", \"width=420,height=720\");\n  if (!w) {\n    alert(\n      \"No se pudo abrir la ventana de resumen. Revis√° el bloqueador de pop-ups.\"\n    );\n    return;\n  }\n  w.focus();\n\n  // üëá TRUCO: a partir de ac√° usamos `win`, que TS ya sabe que es `Window`\n  const win = w;\n\n  const nf = new Intl.NumberFormat(\"es-AR\", {\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  });\n  const q = (v: unknown) => '\"' + String(v ?? \"\").replace(/\"/g, '\"\"') + '\"';\n\n  function render(criterio: \"cantidad_desc\" | \"total_desc\" | \"nombre_asc\") {\n    const ps = [...baseProductos];\n    if (criterio === \"cantidad_desc\")\n      ps.sort(\n        (a, b) =>\n          b.cantidad - a.cantidad || a.producto.localeCompare(b.producto)\n      );\n    if (criterio === \"total_desc\")\n      ps.sort(\n        (a, b) => b.total - a.total || a.producto.localeCompare(b.producto)\n      );\n    if (criterio === \"nombre_asc\")\n      ps.sort((a, b) => a.producto.localeCompare(b.producto));\n\n    const partes: string[] = [];\n    partes.push('<html><head><meta charset=\"utf-8\" />');\n    partes.push(\"<title>Resumen por producto</title>\");\n    partes.push(\n      \"<style>body{font-family:system-ui,Arial,sans-serif;padding:12px;}h1{font-size:16px;margin:0 0 8px;text-align:center;}h2{font-size:14px;margin:12px 0 6px;display:flex;gap:8px;align-items:center;justify-content:space-between;}table{width:100%;border-collapse:collapse;margin:6px 0;}th,td{border-bottom:1px solid #ddd;padding:4px;}th{text-align:left;}.tot{font-weight:bold;font-size:14px;padding:8px 0;text-align:right;}.muted{color:#555}.actions{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;}a.btn,button.btn{padding:6px 10px;border:1px solid #333;background:#fff;cursor:pointer;text-decoration:none;color:#111;border-radius:6px;}a.btn:hover,button.btn:hover{background:#f3f3f3}@media print{.actions,.toolbar{display:none}}.toolbar{display:flex;align-items:center;gap:8px}</style></head><body>\"\n    );\n    partes.push(\"<h1>Resumen por producto</h1>\");\n    partes.push(\n      '<div class=\"muted\">Generado: ' +\n        new Date().toLocaleString() +\n        \"</div>\"\n    );\n\n    // Header + selector de orden\n    partes.push(\n      '<h2><span>Por producto</span><div class=\"toolbar\"><label for=\"orden\">Ordenar por:</label><select id=\"orden\"><option value=\"cantidad_desc\"' +\n        (criterio === \"cantidad_desc\" ? \" selected\" : \"\") +\n        '>Cantidad ‚Üì (m√°s vendido)</option><option value=\"total_desc\"' +\n        (criterio === \"total_desc\" ? \" selected\" : \"\") +\n        '>Total ‚Üì</option><option value=\"nombre_asc\"' +\n        (criterio === \"nombre_asc\" ? \" selected\" : \"\") +\n        \">Producto A‚ÜíZ</option></select></div></h2>\"\n    );\n\n    // Tabla por producto\n    partes.push(\n      '<table><thead><tr><th>Producto</th><th style=\"text-align:right\">Cant.</th><th style=\"text-align:right\">Total</th></tr></thead><tbody id=\"tbody-productos\">'\n    );\n    if (!ps.length) {\n      partes.push('<tr><td colspan=\"3\" class=\"muted\">Sin ventas</td></tr>');\n    } else {\n      ps.forEach((r) => {\n        partes.push(\n          \"<tr><td>\" +\n            r.producto +\n            '</td><td style=\"text-align:right\">' +\n            r.cantidad +\n            '</td><td style=\"text-align:right\">$' +\n            nf.format(r.total) +\n            \"</td></tr>\"\n        );\n      });\n    }\n    partes.push(\"</tbody></table>\");\n\n    // Tabla por lugar\n    const lugares = [...baseLugares].sort(\n      (a, b) => b.total - a.total || a.lugar.localeCompare(b.lugar)\n    );\n    partes.push(\n      '<h2>Por lugar de consumo</h2><table><thead><tr><th>Lugar</th><th style=\"text-align:right\">Total</th></tr></thead><tbody id=\"tbody-lugares\">'\n    );\n    if (!lugares.length) {\n      partes.push('<tr><td colspan=\"2\" class=\"muted\">Sin ventas</td></tr>');\n    } else {\n      lugares.forEach((r) => {\n        partes.push(\n          \"<tr><td>\" +\n            r.lugar +\n            '</td><td style=\"text-align:right\">$' +\n            nf.format(r.total) +\n            \"</td></tr>\"\n        );\n      });\n    }\n    partes.push(\"</tbody></table>\");\n\n    // Total general (solo vigentes)\n    const totalGeneral = ps.reduce((s, r) => s + r.total, 0);\n    partes.push(\n      '<div class=\"tot\" id=\"total-general\">Total general: $' +\n        nf.format(totalGeneral) +\n        \"</div>\"\n    );\n\n    // CSVs (solo vigentes)\n    const headProd = [\"Producto\", \"Cantidad\", \"Total\"].join(\";\");\n    const rowsProd = ps.map((r) =>\n      [q(r.producto), q(r.cantidad), q(r.total)].join(\";\")\n    );\n    const csvProductos = [\n      headProd,\n      ...rowsProd,\n      \"\",\n      \"Total general;;\" + q(totalGeneral),\n    ].join(\"\\n\");\n    const urlCSVProductos =\n      \"data:text/csv;charset=utf-8,\" + encodeURIComponent(csvProductos);\n\n    const headLugar = [\"Lugar\", \"Total\"].join(\";\");\n    const rowsLugar = lugares.map((r) =>\n      [q(r.lugar), q(r.total)].join(\";\")\n    );\n    const csvLugares = [headLugar, ...rowsLugar].join(\"\\n\");\n    const urlCSVLugar =\n      \"data:text/csv;charset=utf-8,\" + encodeURIComponent(csvLugares);\n\n    // Acciones\n    partes.push('<div class=\"actions\">');\n    partes.push(\n      '<a class=\"btn\" href=\"' +\n        urlCSVProductos +\n        '\" download=\"resumen_por_producto.csv\">Descargar CSV (por producto)</a>'\n    );\n    partes.push(\n      '<a class=\"btn\" href=\"' +\n        urlCSVLugar +\n        '\" download=\"resumen_por_lugar.csv\">Descargar CSV (por lugar)</a>'\n    );\n    partes.push(\n      '<button class=\"btn\" onclick=\"window.print()\">Descargar PDF (Imprimir)</button>'\n    );\n    partes.push(\n      '<button class=\"btn\" onclick=\"window.close()\">Cerrar</button>'\n    );\n    partes.push(\"</div>\");\n\n    partes.push(\"</body></html>\");\n\n    // üëá Ahora usamos `win`, que es de tipo `Window`, sin null\n    win.document.open();\n    win.document.write(partes.join(\"\"));\n    win.document.close();\n\n    const sel: any = win.document.getElementById(\"orden\");\n    if (sel) {\n      sel.onchange = () => {\n        win.close();\n        render(sel.value);\n      };\n    }\n  }\n\n  render(\"cantidad_desc\");\n};\n\n  const abrirResumenPorVenta = () => {\n  const ventas = estado.ventas;\n  if (!ventas.length) {\n    alert(\"No hay ventas registradas.\");\n    return;\n  }\n\n  // Agrupar TODAS las ventas por n√∫mero de venta\n  const porVenta: Record<number, Venta[]> = {};\n\n  ventas.forEach((v) => {\n    if (!porVenta[v.numeroVenta]) {\n      porVenta[v.numeroVenta] = [];\n    }\n    porVenta[v.numeroVenta].push(v);\n  });\n\n  // Tipo para cada grupo\n  type GrupoVenta = {\n    numeroVenta: number;\n    items: Venta[];\n    subtotal: number;\n    anulada: boolean;\n  };\n\n  // Ordenar grupos y calcular subtotal + si est√° anulada\n  const grupos: GrupoVenta[] = Object.entries(porVenta)\n    .map(([num, items]) => {\n      const subtotal = items.reduce(\n        (s, it) => s + it.cantidad * it.precio,\n        0\n      );\n      const anulada = items.some((it) => it.anulada);\n      return {\n        numeroVenta: Number(num),\n        items,\n        subtotal,\n        anulada,\n      };\n    })\n    .sort((a, b) => a.numeroVenta - b.numeroVenta);\n\n  // Totales globales (con y sin anuladas)\n  const totalInclAnuladas = grupos.reduce((s, g) => s + g.subtotal, 0);\n  const totalSoloVigentes = grupos\n    .filter((g) => !g.anulada)\n    .reduce((s, g) => s + g.subtotal, 0);\n\n  const nf = new Intl.NumberFormat(\"es-AR\", {\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  });\n  const q = (v: unknown) => '\"' + String(v ?? \"\").replace(/\"/g, '\"\"') + '\"';\n\n  // CSV\n  const head = [\n    \"Numero de venta\",\n    \"Producto\",\n    \"Cantidad\",\n    \"Precio unitario\",\n    \"Precio total\",\n    \"Medio de pago\",\n    \"Estado\",\n  ].join(\";\");\n  const rows: string[] = [];\n  grupos.forEach((g) => {\n    const etiqueta = g.anulada\n      ? `${g.numeroVenta} (ANULADA)`\n      : String(g.numeroVenta);\n    g.items.forEach((it) => {\n      const totalLinea = it.cantidad * it.precio;\n      rows.push(\n        [\n          q(etiqueta),\n          q(it.producto),\n          q(it.cantidad),\n          q(it.precio),\n          q(totalLinea),\n          q(it.medioPago),\n          q(g.anulada ? \"ANULADA\" : \"VIGENTE\"),\n        ].join(\";\")\n      );\n    });\n    rows.push(\n      [\n        q(\"Subtotal N¬∞ \" + etiqueta),\n        \"\",\n        \"\",\n        \"\",\n        q(g.subtotal),\n        \"\",\n        \"\",\n      ].join(\";\")\n    );\n    rows.push(\"\");\n  });\n  rows.push(\n    [\n      q(\"Total general (solo vigentes)\"),\n      \"\",\n      \"\",\n      \"\",\n      q(totalSoloVigentes),\n      \"\",\n      \"\",\n    ].join(\";\")\n  );\n  rows.push(\n    [\n      q(\"Total general (incl. anuladas)\"),\n      \"\",\n      \"\",\n      \"\",\n      q(totalInclAnuladas),\n      \"\",\n      \"\",\n    ].join(\";\")\n  );\n\n  const urlCSV =\n    \"data:text/csv;charset=utf-8,\" +\n    encodeURIComponent([head, ...rows].join(\"\\n\"));\n\n  // Popup\n  const w = window.open(\"\", \"ResumenPorVenta\", \"width=560,height=720\");\n  if (!w) {\n    alert(\n      \"No se pudo abrir la ventana de resumen. Revis√° el bloqueador de pop-ups.\"\n    );\n    return;\n  }\n  w.focus();\n  const win = w; // üëà truco para que TS sepa que no es null\n\n  const estilos = `\n      body{font-family:system-ui,Arial,sans-serif;padding:12px;}\n      h1{font-size:16px;margin:0 0 8px;text-align:center;}\n      h2{font-size:14px;margin:12px 0 6px;}\n      table{width:100%;border-collapse:collapse;margin:6px 0;}\n      th,td{border-bottom:1px solid #ddd;padding:6px;}\n      th{text-align:left;}\n      .muted{color:#555}\n      .tot{font-weight:bold}\n      .actions{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;}\n      .btn{padding:6px 10px;border:1px solid #333;background:#fff;cursor:pointer;text-decoration:none;color:#111;border-radius:6px;}\n      .btn:hover{background:#f3f3f3}\n      @media print{.actions{display:none}}\n    `;\n\n  const partes: string[] = [];\n  partes.push('<html><head><meta charset=\"utf-8\"/>');\n  partes.push(\"<title>Resumen por venta</title>\");\n  partes.push(`<style>${estilos}</style></head><body>`);\n  partes.push(\"<h1>Resumen por venta</h1>\");\n  partes.push(\n    '<div class=\"muted\">Generado: ' + new Date().toLocaleString() + \"</div>\"\n  );\n\n  partes.push(\n    \"<table><thead><tr>\" +\n      '<th style=\"text-align:center;width:110px;\">N¬∞ Venta</th>' +\n      \"<th>Producto</th>\" +\n      '<th style=\"text-align:right;width:80px;\">Cant.</th>' +\n      '<th style=\"text-align:right;width:100px;\">Precio unit.</th>' +\n      '<th style=\"text-align:right;width:110px;\">Precio total</th>' +\n      '<th style=\"text-align:left;width:110px;\">Medio</th>' +\n      '<th style=\"text-align:left;width:90px;\">Estado</th>' +\n      \"</tr></thead><tbody>\"\n  );\n\n  if (!grupos.length) {\n    partes.push(\n      '<tr><td colspan=\"7\" style=\"text-align:center;color:#555;\">Sin ventas</td></tr>'\n    );\n  } else {\n    grupos.forEach((g) => {\n      // cabecera del grupo\n      partes.push(\n        `<tr><td colspan=\"7\" style=\"padding-top:10px;font-weight:bold;background:#f6f6f6;\">Venta N¬∞ ${g.numeroVenta}` +\n          (g.anulada ? ' <span style=\"color:red\">(ANULADA)</span>' : \"\") +\n          \"</td></tr>\"\n      );\n\n      // l√≠neas\n      g.items.forEach((it) => {\n        const totalLinea = it.cantidad * it.precio;\n        partes.push(\"<tr>\");\n        partes.push(`<td style=\"text-align:center\">${g.numeroVenta}</td>`);\n        partes.push(`<td>${it.producto}</td>`);\n        partes.push(`<td style=\"text-align:right\">${it.cantidad}</td>`);\n        partes.push(\n          `<td style=\"text-align:right\">$${nf.format(it.precio)}</td>`\n        );\n        partes.push(\n          `<td style=\"text-align:right\">$${nf.format(totalLinea)}</td>`\n        );\n        partes.push(`<td>${it.medioPago}</td>`);\n        partes.push(`<td>${g.anulada ? \"ANULADA\" : \"VIGENTE\"}</td>`);\n        partes.push(\"</tr>\");\n      });\n\n      // subtotal\n      partes.push(\n        `<tr><td colspan=\"5\" style=\"text-align:right;font-weight:bold;\">SUBTOTAL Venta N¬∞ ${g.numeroVenta}</td>` +\n          `<td style=\"text-align:left;font-weight:bold;\">$${nf.format(\n            g.subtotal\n          )}</td>` +\n          `<td></td></tr>`\n      );\n\n      // separador\n      partes.push(\n        '<tr><td colspan=\"7\" style=\"border-bottom:2px solid #000;\"></td></tr>'\n      );\n    });\n  }\n\n  // Totales globales al final\n  partes.push(\n    `<tr><td colspan=\"5\" font-bold style=\"text-align:right;color:#555;\">Total general</td>` +\n      `<td style=\"text-align:left;color:#555;\">$${nf.format(\n        totalSoloVigentes\n      )}</td><td></td></tr>`\n  );\n  partes.push(\n    `<tr><td colspan=\"5\" style=\"text-align:right;color:#555;\">Total incluyendo anuladas</td>` +\n      `<td style=\"text-align:left;color:#555;\">$${nf.format(\n        totalInclAnuladas\n      )}</td><td></td></tr>`\n  );\n\n  partes.push(\"</tbody></table>\");\n\n  partes.push(\n    '<div class=\"actions\">' +\n      `<a class=\"btn\" href=\"${urlCSV}\" download=\"resumen_por_venta.csv\">Descargar CSV</a>` +\n      '<button class=\"btn\" onclick=\"window.print()\">Descargar PDF (Imprimir)</button>' +\n      '<button class=\"btn\" onclick=\"window.close()\">Cerrar</button>' +\n      \"</div>\"\n  );\n\n  partes.push(\"</body></html>\");\n\n  win.document.open();\n  win.document.write(partes.join(\"\"));\n  win.document.close();\n};\n\n  const limpiarSeleccion = () =>\n    setEstado((prev) => ({\n      ...prev,\n      seleccionados: {}, // antes\n      lineas: [], // üëà clave: vaciamos las l√≠neas del carrito\n      modificadores: {}, // üëà por si qued√≥ algo marcado\n      mensajeTicket: \"\",\n      pagosActuales: { ...estadoVacioPagos },\n    }));\n\n  const calcularTotal = () => {\n    return estado.lineas.reduce((total, linea) => {\n      const prod = productos.find((p) => p.id === linea.productoId);\n      if (!prod) return total;\n      const extra = extrasDeltaUnitario(linea.productoId, linea.mods);\n      const unit = prod.precio + extra;\n      return total + unit * (linea.qty || 1); // üëà qty\n    }, 0);\n  };\n\n  const imprimirTicket = (\n    ventas: Venta[],\n    pagos?: Record<MedioPago, number>\n  ) => {\n    const { fecha } = nowParts();\n    // en vez de new Date().toISOString().split(\"T\")[0]\n    const ventana = window.open(\"\", \"Ticket\", \"width=300,height=500\");\n    if (!ventana) {\n      alert(\n        \"No se pudo abrir la ventana de impresi√≥n. Revis√° el bloqueador de pop-ups.\"\n      );\n      return;\n    }\n\n    const partes: string[] = [];\n    partes.push('<div class=\"ticket\">');\n    partes.push(\n      '<p style=\"font-weight:bold; font-size:16px; margin:0; text-align:center;\">Carribar San Jorge</p>'\n    );\n    partes.push(\n      '<p style=\"font-weight:bold; font-size:12px; margin:0; text-align:center;\">Fecha: ' +\n        fecha +\n        \"</p>\"\n    );\n    partes.push(\n      '<p style=\"font-weight:bold; font-size:12px; margin:0; text-align:center;\">N¬∞ Ticket: ' +\n        estado.numeroVentaActual +\n        \"</p>\"\n    );\n    partes.push(\n      '<div style=\"border-top:1px dashed #000; margin:4px 0 0 0;\"></div>'\n    );\n\n    ventas.forEach((v) => {\n      const subtotal = v.precio * v.cantidad;\n\n      // L√≠nea del producto (FILA FLEX)\n      partes.push(\n        '<div style=\"display:flex; align-items:center; font-size:14px; font-weight:bold; margin:0;\">' +\n          '<span style=\"width:10%; text-align:center;\">' +\n          v.cantidad +\n          \"x</span>\" +\n          '<span style=\"width:60%; text-align:center;\">' +\n          v.producto +\n          \"</span>\" +\n          '<span style=\"width:30%; text-align:center;\">$' +\n          fmtAR(subtotal) +\n          \"</span>\" +\n          \"</div>\"\n      );\n\n      // üîΩ Modificadores (BLOQUE PROPIO, NO FLEX) ‚Äî DEBAJO de la l√≠nea\n      if (v.mensajeTicket) {\n        partes.push(\n          '<div style=\"font-size:10px; text-align:left; margin:0 0 2px 0; padding-left:2px;\">' +\n            \"&gt; \" +\n            v.mensajeTicket +\n            \"</div>\"\n        );\n      }\n\n      // Separador\n      partes.push(\n        '<div style=\"border-bottom:1px dotted #000; margin:2px 0;\"></div>'\n      );\n    });\n\n    partes.push(\n      '<div style=\"border-top:1px dashed #000; margin:4px 0;\"></div>'\n    );\n    partes.push(\n      '<p style=\"font-weight:bold; font-size:14px; margin:0;\">Obs: ' +\n        (estado.mensajeTicket || \"\") +\n        \"</p>\"\n    );\n    partes.push(\n      '<p style=\"font-weight:bold; font-size:14px; margin:0; text-align:left;\">Lugar consumo: ' +\n        estado.lugarConsumo +\n        \"</p>\"\n    );\n\n    if (pagos) {\n      const items = MEDIOS.filter((m) => (pagos[m] || 0) > 0);\n      if (items.length) {\n        partes.push(\n          '<div style=\"border-top:1px dashed #000; margin:4px 0;\"></div>'\n        );\n        partes.push(\n          '<p style=\"font-weight:bold; font-size:10px; margin:0; text-align:left;\">Pagos:</p>'\n        );\n        items.forEach((m) => {\n          partes.push(\n            '<div style=\"display:flex; justify-content:space-between; font-size:10px;\">' +\n              `<span>${m}</span><span>$${fmtAR(pagos[m])}</span>` +\n              \"</div>\"\n          );\n        });\n      }\n    }\n\n    partes.push(\n      '<p style=\"font-weight:bold; font-size:16px; margin:4px 0 0 0; text-align:center; border:2px solid #000; padding:4px;\">'\n    );\n    partes.push(\"  Total: $\" + fmtAR(totalVentas(ventas)));\n    partes.push(\"</p>\");\n    partes.push(\"</div>\");\n\n    ventana.document.write(partes.join(\"\"));\n    ventana.document.close();\n    ventana.print();\n    ventana.close();\n  };\n\n  // ====== IMPRIMIR COMANDA (con qty por l√≠nea) ======\n  // ====== IMPRIMIR COMANDA (con qty por l√≠nea) ======\n  const imprimirComanda = () => {\n    if (estado.lineas.length === 0) {\n      alert(\"No hay productos seleccionados.\");\n      return;\n    }\n\n    // 1) ABRIR POPUP INMEDIATAMENTE (por el gesto del usuario)\n    //    Esto evita que el bloqueador lo considere \"no iniciado por el usuario\".\n    const popup = window.open(\"\", \"Comanda\", \"width=300,height=500\");\n    if (!popup) {\n      alert(\n        \"No se pudo abrir la ventana de impresi√≥n. Revis√° el bloqueador de pop-ups.\"\n      );\n      return;\n    }\n\n    // 2) Ahora s√≠, guardar la comanda pendiente\n    const comanda = crearComandaActual(estado);\n    setEstado((prev) => ({\n      ...prev,\n      comandas: [...prev.comandas, comanda],\n    }));\n\n    // 3) Construir el HTML (igual que antes)\n    const { fecha } = nowParts();\n    const partes: string[] = [];\n    partes.push(\"<html><head><meta charset='utf-8'/>\");\n    partes.push(`\n    <style>\n      @media print { @page { size: 80mm auto; margin: 2mm; } .ticket { width: 72mm; } }\n      body { font-family: system-ui, Arial, sans-serif; }\n    </style>\n  `);\n    partes.push(\"</head><body>\");\n    partes.push('<div class=\"ticket\">');\n    partes.push(\n      '<p style=\"font-weight:bold; font-size:16px; margin:0; text-align:center;\">Carribar San Jorge</p>'\n    );\n    partes.push(\n      '<p style=\"font-weight:bold; font-size:12px; margin:0;text-align:center;\">Fecha: ' +\n        fecha +\n        \"</p>\"\n    );\n    partes.push(\n      '<div style=\"border-top:1px dashed #000; margin:4px 0 0 0;\"></div>'\n    );\n\n    estado.lineas.forEach((linea) => {\n      const producto = productos.find((p) => p.id === linea.productoId);\n      if (!producto) return;\n      const q = linea.qty || 1;\n\n      partes.push(\n        '<div style=\"display:flex; align-items:center; font-size:16px; font-weight:bold; margin:0;\">' +\n          `<span style=\"width:10%; text-align:center;\">${q}x</span>` +\n          '<span style=\"width:90%; text-align:center;\">' +\n          producto.nombre +\n          \"</span>\" +\n          \"</div>\"\n      );\n\n      const detalleMods = modsTexto(linea.productoId, linea.mods);\n      if (detalleMods) {\n        partes.push(\n          '<div style=\"font-size:12px; text-align:left; margin:0 0 2px 0; padding-left:2px;\">' +\n            \"&gt; \" +\n            detalleMods +\n            \"</div>\"\n        );\n      }\n      partes.push(\n        '<div style=\"border-bottom:1px dotted #000; margin:2px 0;\"></div>'\n      );\n    });\n\n    partes.push(\n      '<div style=\"border-top:1px dashed #000; margin:4px 0;\"></div>'\n    );\n    partes.push(\n      '<p style=\"font-weight:bold; font-size:14px; margin:0;\">Obs: ' +\n        (estado.mensajeTicket || \"\") +\n        \"</p>\"\n    );\n    partes.push(\n      '<p style=\"font-weight:bold; font-size:14px; margin:0; text-align:left;\">Lugar consumo: ' +\n        estado.lugarConsumo +\n        \"</p>\"\n    );\n    partes.push(\"</div></body></html>\");\n\n    // 4) Escribir y luego imprimir con un peque√±o delay (Chrome suele necesitarlo)\n    popup.document.open();\n    popup.document.write(partes.join(\"\"));\n    popup.document.close();\n\n    // En algunos navegadores, imprimir inmediatamente despu√©s de write() no funciona.\n    // Peque√±o delay para asegurar que el contenido ya est√© renderizado.\n    setTimeout(() => {\n      try {\n        popup.focus();\n        popup.print();\n        popup.close();\n      } catch {\n        // Fallback s√∫per b√°sico: si print falla, al menos dejamos la ventana abierta.\n        popup.focus();\n      }\n    }, 50);\n\n    // 5) Limpiar carrito (igual que antes)\n    setEstado((prev) => ({\n      ...prev,\n      seleccionados: {},\n      lineas: [],\n      modificadores: {},\n      mensajeTicket: \"\",\n      pagosActuales: { ...estadoVacioPagos },\n    }));\n  };\n  // Abre modal de comandas\n  const [comandasAbierto, setComandasAbierto] = useState(false);\n  const [buscaComanda, setBuscaComanda] = useState(\"\");\n\n  const abrirComandas = () => setComandasAbierto(true);\n  const cerrarComandas = () => setComandasAbierto(false);\n\n  // Cargar comanda al carrito (sin cobrar todav√≠a)\n  const cargarComanda = (id: string) => {\n    setEstado((prev) => {\n      const c = prev.comandas.find((x) => x.id === id);\n      if (!c) return prev;\n      const lineas = c.lineas.map(cloneLinea); // nuevo uid\n      return {\n        ...prev,\n        lineas,\n        seleccionados: seleccionadosFromLineas(lineas),\n        comandaEnProcesoId: id,\n        // limpi√° pagos/obs previos para evitar arrastre\n        mensajeTicket: c.obs || \"\",\n        pagosActuales: { ...estadoVacioPagos },\n      };\n    });\n    setComandasAbierto(false);\n  };\n\n  // Confirmar directo: carga y abre el modal de cobro\n  const confirmarComanda = (id: string) => {\n    cargarComanda(id);\n    // abrimos cobro enseguida (peque√±o delay por setState)\n    setTimeout(() => abrirCobro(), 0);\n  };\n\n  // Eliminar/anular comanda pendiente\n  const eliminarComanda = (id: string) => {\n    setEstado((prev) => ({\n      ...prev,\n      comandas: prev.comandas.filter((c) => c.id !== id),\n      // por si estaba en proceso\n      comandaEnProcesoId:\n        prev.comandaEnProcesoId === id ? null : prev.comandaEnProcesoId,\n    }));\n  };\n\n  // ¬øLa venta N¬∞ X est√° anulada?\n  const ventaEstaAnulada = (vs: Venta[], numero: number) =>\n    vs.some((v) => v.numeroVenta === numero && v.anulada);\n\n  // Crea LineaSeleccion desde una Venta (respetando qty/mods)\n  const lineaFromVenta = (v: Venta): LineaSeleccion | null => {\n    const prodId =\n      v.productId ?? productos.find((p) => p.nombre === v.producto)?.id ?? null;\n    if (!prodId) return null;\n    return {\n      uid: Math.random().toString(36).slice(2) + Date.now().toString(36),\n      productoId: prodId,\n      mods: { ...(v.mods || {}) },\n      qty: v.cantidad || 1,\n    };\n  };\n  const guardarCambiosEnComanda = () => {\n    setEstado((prev) => {\n      const id = prev.comandaEnProcesoId;\n      if (!id) return prev;\n\n      const existe = prev.comandas.find((c) => c.id === id);\n      if (!existe) return prev;\n\n      const lineasActualizadas = prev.lineas.map(cloneLinea); // mantener uids nuevos\n      return {\n        ...prev,\n        comandas: prev.comandas.map((c) =>\n          c.id === id\n            ? {\n                ...c,\n                lineas: lineasActualizadas,\n                obs: prev.mensajeTicket || \"\", // usa el campo \"Aclaraciones\"\n              }\n            : c\n        ),\n      };\n    });\n  };\n\n  const confirmarVenta = () => {\n    if (estado.lineas.length === 0) {\n      // antes mirabas seleccionados\n      alert(\"No se puede confirmar la venta. No hay productos seleccionados.\");\n      return;\n    }\n    abrirCobro();\n  };\n\n  const abrirCierreConConteo = () => {\n    const desdeISO = estado.ultimoCierreISO || \"1970-01-01T00:00:00.000Z\";\n\n    // Pagos dentro del per√≠odo\n    const pagosPeriodo = estado.pagos.filter((p) => p.createdAtISO > desdeISO);\n\n    // Conjunto de tickets anulados\n    const anuladas = new Set(\n      estado.ventas.filter((v) => v.anulada).map((v) => v.numeroVenta)\n    );\n\n    // ‚¨áÔ∏è Solo pagos de ventas vigentes (excluye anuladas)\n    const pagosVigentes = pagosPeriodo.filter(\n      (p) => !anuladas.has(p.numeroVenta)\n    );\n\n    if (pagosVigentes.length === 0) {\n      alert(\"No hay pagos de ventas vigentes desde el √∫ltimo cierre.\");\n      return;\n    }\n\n    // Totales por medio solo con vigentes\n    const totalesPorMedio: Record<MedioPago, number> = {\n      Efectivo: 0,\n      D√©bito: 0,\n      Cr√©dito: 0,\n      QR: 0,\n      Cuenta: 0,\n    };\n    pagosVigentes.forEach((p) => {\n      totalesPorMedio[p.medio] += p.monto;\n    });\n\n    const totalGeneral = pagosVigentes.reduce((s, p) => s + p.monto, 0);\n    const cantidadVentas = new Set(pagosVigentes.map((p) => p.numeroVenta))\n      .size;\n\n    setResumenCorte({\n      desdeISO,\n      hastaISO: new Date().toISOString(),\n      cantidadVentas,\n      totalesPorMedio,\n      totalGeneral,\n    });\n\n    // inicializo campos en blanco\n    setBilletes({\n      b100: \"\",\n      b200: \"\",\n      b500: \"\",\n      b1000: \"\",\n      b2000: \"\",\n      b10000: \"\",\n      b20000: \"\",\n    });\n    setCuentas({ bica: \"\", mp: \"\", macro: \"\" });\n    setCierreAbierto(true);\n  };\n\n  const confirmarCierreConConteo = () => {\n    if (!resumenCorte) {\n      setCierreAbierto(false);\n      return;\n    }\n\n    const nf = new Intl.NumberFormat(\"es-AR\", {\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0,\n    });\n\n    // diferencias por medio (se calculan pero no se muestran como principal)\n    const esperadoEfvo = resumenCorte.totalesPorMedio[\"Efectivo\"];\n    const contadoEfvo = totalEfectivoContado();\n\n    const esperadoMP = resumenCorte.totalesPorMedio[\"QR\"]; // asumimos MP ~ QR\n    const contadoMP = Number(cuentas.mp || 0);\n\n    const esperadoCuenta = resumenCorte.totalesPorMedio[\"Cuenta\"];\n    const contadoCuenta = totalCuentasBicaMacroContado();\n\n    // === NUEVO: sumatoria total contada y comparaci√≥n global ===\n    const contadoTotal = contadoEfvo + contadoMP + contadoCuenta;\n    const esperadoTotal = resumenCorte.totalGeneral;\n    const difTotal = contadoTotal - esperadoTotal;\n\n    // Popup imprimible\n    const w = window.open(\"\", \"CierreCaja\", \"width=460,height=720\");\n    if (!w) {\n      alert(\"Bloqueador de pop-ups.\");\n      return;\n    }\n\n    const estilos = `\n      body{font-family:system-ui,Arial,sans-serif;padding:12px;}\n      h1{font-size:16px;margin:0 0 8px;text-align:center;}\n      h2{font-size:14px;margin:12px 0 6px;}\n      table{width:100%;border-collapse:collapse;margin:6px 0;}\n      th,td{border-bottom:1px solid #ddd;padding:6px;}\n      th{text-align:left;}\n      .grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;}\n      .muted{color:#555}\n      .ok{color:#166534;font-weight:bold}\n      .bad{color:#991b1b;font-weight:bold}\n      .actions{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;}\n      .btn{padding:6px 10px;border:1px solid #333;background:#fff;cursor:pointer;text-decoration:none;color:#111;border-radius:6px;}\n      .btn:hover{background:#f3f3f3}\n      @media print{.actions{display:none}}\n    `;\n\n    const clase = (n: number) => (n === 0 ? \"ok\" : \"bad\");\n\n    const partes: string[] = [];\n    partes.push(\n      '<html><head><meta charset=\"utf-8\"/><title>Cierre de caja</title>'\n    );\n    partes.push(`<style>${estilos}</style></head><body>`);\n    partes.push(\"<h1>Cierre de caja</h1>\");\n    partes.push(`<div>Desde: ${resumenCorte.desdeISO}</div>`);\n    partes.push(`<div>Hasta: ${resumenCorte.hastaISO}</div>`);\n    partes.push(`<div>Tickets incluidos: ${resumenCorte.cantidadVentas}</div>`);\n\n    // Totales sistema por medio (informativo)\n        partes.push(\"<h2>Totales del sistema</h2>\");\n    partes.push(\n      '<table><thead><tr><th>Medio</th><th style=\"text-align:right\">Total</th></tr></thead><tbody>'\n    );\n\n    const mediosResumen: MedioPago[] = [\"Efectivo\", \"D√©bito\", \"Cr√©dito\", \"QR\", \"Cuenta\"];\n\n    mediosResumen.forEach((mp) => {\n      partes.push(\n        `<tr><td>${mp}</td><td style=\"text-align:right\">$${nf.format(\n          resumenCorte.totalesPorMedio[mp] ?? 0\n        )}</td></tr>`\n      );\n    });\n\n    partes.push(\n      `<tr><td style=\"font-weight:bold\">Total general</td><td style=\"text-align:right;font-weight:bold\">$${nf.format(\n        resumenCorte.totalGeneral\n      )}</td></tr>`\n    );\n    partes.push(\"</tbody></table>\");\n\n    // Conteo realizado (informativo)\n    partes.push(\"<h2>Conteo realizado</h2>\");\n    partes.push('<div class=\"grid\">');\n    partes.push(\n      `<div>Efectivo contado</div><div style=\"text-align:right\">$${nf.format(\n        contadoEfvo\n      )}</div>`\n    );\n    partes.push(\n      `<div>MP (contado)</div><div style=\"text-align:right\">$${nf.format(\n        contadoMP\n      )}</div>`\n    );\n    partes.push(\n      `<div>Bica + Macro (contado)</div><div style=\"text-align:right\">$${nf.format(\n        contadoCuenta\n      )}</div>`\n    );\n    partes.push(\"</div>\");\n\n    // ==== NUEVO: Resumen global √∫nico ====\n    partes.push(\"<h2>Resumen</h2>\");\n    partes.push(\"<table><tbody>\");\n    partes.push(\n      `<tr><td>Total del sistema</td><td style=\"text-align:right\">$${nf.format(\n        esperadoTotal\n      )}</td></tr>`\n    );\n    partes.push(\n      `<tr><td>Total contado (Efvo + MP + Cuentas)</td><td style=\"text-align:right\">$${nf.format(\n        contadoTotal\n      )}</td></tr>`\n    );\n    partes.push(\n      `<tr><td><b>Diferencia (contado - sistema)</b></td><td class=\"${clase(\n        difTotal\n      )}\" style=\"text-align:right\"><b>$${nf.format(difTotal)}</b></td></tr>`\n    );\n    partes.push(\"</tbody></table>\");\n\n    partes.push('<div class=\"actions\">');\n    partes.push(\n      '<button class=\"btn\" onclick=\"window.print()\">Imprimir / PDF</button>'\n    );\n    partes.push('<button class=\"btn\" onclick=\"window.close()\">Cerrar</button>');\n    partes.push(\"</div>\");\n    partes.push(\"</body></html>\");\n\n    w.document.write(partes.join(\"\"));\n    w.document.close();\n    w.focus();\n\n    // Guardar cierre e iniciar nuevo per√≠odo\n    const cierre: CierreCaja = {\n      id: resumenCorte.hastaISO,\n      desdeISO: resumenCorte.desdeISO,\n      hastaISO: resumenCorte.hastaISO,\n      totalesPorMedio: resumenCorte.totalesPorMedio,\n      totalGeneral: resumenCorte.totalGeneral,\n      cantidadVentas: resumenCorte.cantidadVentas,\n    };\n\n    setEstado((prev) => ({\n      ...prev,\n      cierresCaja: [...prev.cierresCaja, cierre],\n      ultimoCierreISO: resumenCorte.hastaISO,\n    }));\n\n    setCierreAbierto(false);\n    setResumenCorte(null);\n  };\n\n  const descargarRegistro = () => {\n    const q = (v: unknown) => `\"${String(v ?? \"\").replace(/\"/g, '\"\"')}\"`;\n    const header = [\n      \"numeroVenta\",\n      \"fecha\",\n      \"hora\",\n      \"createdAtISO\",\n      \"producto\",\n      \"cantidad\",\n      \"precio\",\n      \"obs\",\n      \"lugarConsumo\",\n      \"medioPago\",\n    ].join(\";\");\n\n    const rows = estado.ventas.map((v) =>\n      [\n        q(v.numeroVenta),\n        q(v.fecha),\n        q(v.hora),\n        q(v.createdAtISO),\n        q(v.producto),\n        q(v.cantidad),\n        q(v.precio),\n        q(v.mensajeTicket ?? \"\"),\n        q(v.lugarConsumo),\n        q(v.medioPago),\n      ].join(\";\")\n    );\n\n    const csv = [header, ...rows].join(\"\\n\");\n    const a = document.createElement(\"a\");\n    a.href = `data:text/csv;charset=utf-8,${encodeURIComponent(csv)}`;\n    a.target = \"_blank\";\n    a.download = \"registro_ventas.csv\";\n    a.click();\n  };\n  const getModDefs = (productoId: number): ModificadorDef[] =>\n    MODS_POR_PRODUCTO[productoId] || [];\n\n  const getModsState = (\n    modificadores: Estado[\"modificadores\"],\n    productoId: number\n  ) => modificadores[productoId] || {};\n\n  const extrasDeltaUnitario = (\n    productoId: number,\n    modsState: Partial<Record<ModificadorKey, boolean>>\n  ) => {\n    const defs = getModDefs(productoId);\n    return defs.reduce(\n      (s, d) => s + ((modsState[d.key] ? d.delta : 0) || 0),\n      0\n    );\n  };\n\n  const modsTexto = (\n    productoId: number,\n    modsState: Partial<Record<ModificadorKey, boolean>>\n  ) => {\n    const defs = getModDefs(productoId);\n    return defs\n      .filter((d) => !!modsState[d.key])\n      .map((d) => (d.delta > 0 ? `${d.label} (+$${fmtAR(d.delta)})` : d.label))\n      .join(\" | \");\n  };\n\n  const imprimirUltimoTicket = () => {\n    const ultimasVentas = estado.ventas.filter(\n      (v) => v.numeroVenta === estado.numeroVentaActual - 1\n    );\n    if (ultimasVentas.length === 0) {\n      alert(\"No hay ticket anterior.\");\n      return;\n    }\n    imprimirTicket(ultimasVentas);\n  };\n  const borrarRegistro = () => {\n    localStorage.removeItem(\"estado\");\n    setEstado(initialState);\n  };\n\n  const reiniciarRegistro = () => {\n    const confirmacion = confirm(\"¬øEst√°s seguro de reiniciar el registro?\");\n    if (confirmacion) borrarRegistro();\n  };\n\n  /* ========================= UI ========================= */\n  // Titulo en pantalla\n  return (\n    <>\n      <div className=\"w-full p-4 md:p-6 lg:p-8 bg-white rounded-lg shadow-md\">\n       <h1 className=\"titulo\">CARRIBAR SAN JORGE</h1>\n\n\n\n        <p className=\"venta-numero\">\n  Venta N¬∞ {estado.numeroVentaActual}\n</p>\n\n<div className=\"mb-4 border-4 border-green-600 p-2 rounded-lg\">\n  <div className=\"productos-grid w-full\">\n    {productos.map((producto) => (\n      <button\n        key={producto.id}\n        className=\"producto-btn\"\n        onClick={() => seleccionarProducto(producto.id)}\n      >\n        <span className=\"mr-1\">{producto.nombre}</span>\n        <span className=\"text-red-600 whitespace-nowrap\">\n          ${fmtAR(producto.precio)}\n        </span>\n      </button>\n    ))}\n  </div>\n</div>\n\n\n<h2 className=\"subtitulo alto-unico\">\n  Productos seleccionados\n</h2>\n\n\n<ul className=\"list-none lista\">\n  {estado.lineas.length === 0 ? (\n    <li className=\"text-center text-gray-500\">\n      No hay productos agregados.\n    </li>\n  ) : (\n    estado.lineas.map((linea) => {\n      const prod = productos.find((p) => p.id === linea.productoId);\n      const defs = getModDefs(linea.productoId);\n      const extraUnit = extrasDeltaUnitario(linea.productoId, linea.mods);\nconst precioUnit = prod ? prod.precio + extraUnit : 0;\nconst precioTotal = precioUnit * (linea.qty || 1);\n\n      return (\n       <li key={linea.uid} className=\"item-linea\">\n  {/* IZQUIERDA: texto + extra */}\n  <div className=\"item-linea-texto\">\n  <span className=\"font-medium\">\n    {prod?.nombre}: {linea.qty || 1}{\" \"}\n    {(linea.qty || 1) === 1 ? \"Unidad\" : \"Unidades\"}\n  </span>\n\n  {/* Precio unitario */}\n  <span className=\"precio-unit\">\n    ‚Äî ${fmtAR(precioUnit)} c/u\n  </span>\n\n  {/* Precio total (SIEMPRE visible) */}\n  <span className=\"precio-total\">\n    ‚Äî Total: ${fmtAR(precioTotal)}\n  </span>\n</div>\n\n\n\n  {/* DERECHA: botones */}\n  <div className=\"item-linea-botones\">\n    <button\n      className=\"boton-duplicar\"\n      onClick={() => duplicarLinea(linea.uid)}\n      title=\"Sumar 1 a esta l√≠nea\"\n    >\n      Duplicar\n    </button>\n\n    <button\n      className=\"boton-eliminar\"\n      onClick={() => eliminarLinea(linea.uid)}\n      title=\"Quitar toda la l√≠nea\"\n    >\n      Eliminar\n    </button>\n  </div>\n\n  {/* FILA DE ABAJO: modificadores */}\n  {defs.length > 0 && (\n    <div className=\"item-linea-mods\">\n      {defs.map((d) => (\n        <label key={d.key} className=\"mod-label\">\n          <input\n            type=\"checkbox\"\n            checked={!!linea.mods[d.key]}\n            onChange={(e) =>\n              setEstado((prev) => {\n                const lineas = prev.lineas.map((ln) =>\n                  ln.uid === linea.uid\n                    ? {\n                        ...ln,\n                        mods: {\n                          ...ln.mods,\n                          [d.key]: e.target.checked,\n                        },\n                      }\n                    : ln\n                );\n                return { ...prev, lineas };\n              })\n            }\n          />\n          <span>\n  {d.label}\n  {d.delta !== 0 && (\n    <span className={d.delta > 0 ? \"mod-plus\" : \"mod-minus\"}>\n      ({d.delta > 0 ? \"+\" : \"-\"}${fmtAR(Math.abs(d.delta))})\n    </span>\n  )}\n</span>\n        </label>\n      ))}\n    </div>\n  )}\n</li>\n      );\n    })\n  )}\n</ul>\n\n        <p className=\"total-precio alto-unico\">\n  Total: ${fmtAR(calcularTotal())}\n</p>\n\n<div className=\"consumo-y-aclaraciones alto-unico\">\n  {/* IZQUIERDA: Lugar de consumo */}\n  <div className=\"consumo-opciones\">\n    <span className=\"label-consumo\">Lugar de consumo:</span>\n\n    <label className=\"consumo-item\">\n      <input\n        type=\"radio\"\n        name=\"lugarConsumo\"\n        value=\"Aca\"\n        checked={estado.lugarConsumo === \"Aca\"}\n        onChange={() =>\n          setEstado((prev) => ({ ...prev, lugarConsumo: \"Aca\" }))\n        }\n      />\n      Aca\n    </label>\n\n    <label className=\"consumo-item\">\n      <input\n        type=\"radio\"\n        name=\"lugarConsumo\"\n        value=\"Delivery\"\n        checked={estado.lugarConsumo === \"Delivery\"}\n        onChange={() =>\n          setEstado((prev) => ({ ...prev, lugarConsumo: \"Delivery\" }))\n        }\n      />\n      Delivery\n    </label>\n\n    <label className=\"consumo-item\">\n      <input\n        type=\"radio\"\n        name=\"lugarConsumo\"\n        value=\"Retira\"\n        checked={estado.lugarConsumo === \"Retira\"}\n        onChange={() =>\n          setEstado((prev) => ({ ...prev, lugarConsumo: \"Retira\" }))\n        }\n      />\n      Retira\n    </label>\n  </div>\n\n  {/* DERECHA: Aclaraciones */}\n  <input\n    type=\"text\"\n    placeholder=\"Aclaraciones del pedido (opcional)\"\n    value={estado.mensajeTicket}\n    onChange={(e) =>\n      setEstado((prev) => ({ ...prev, mensajeTicket: e.target.value }))\n    }\n    className=\"aclaraciones-input\"\n  />\n</div>\n\n        {/* Acciones principales */}\n      {/* Fila superior: 3 botones centrados */}\n<div\n  style={{\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    gap: \"8px\",\n    marginTop: \"16px\",\n    marginBottom: \"16px\",\n    width: \"100%\",\n  }}\n>\n  <button\n    className=\"btn-base btn-comanda\"\n    onClick={imprimirComanda}\n  >\n    Crear Comanda\n  </button>\n\n  <button\n    className=\"btn-base btn-confirmar\"\n    onClick={confirmarVenta}\n  >\n    Confirmar Venta\n  </button>\n\n  <button\n    className=\"btn-base btn-duplicar\"\n    onClick={abrirComandas}\n  >\n    Comandas pendientes (\n    {estado.comandas.filter((c) => c.estado === \"pendiente\").length})\n  </button>\n</div>\n\n{/* Acciones secundarias (incluye Limpiar) */}\n<div\n  style={{\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    gap: \"8px\",\n    width: \"100%\",\n    marginTop: \"8px\",\n  }}\n>\n  <button\n    className=\"btn-base btn-secundario\"\n    onClick={limpiarSeleccion}\n  >\n    Limpiar\n  </button>\n\n  {estado.comandaEnProcesoId && (\n    <div className=\"mt-2 p-2 border rounded bg-yellow-50 text-sm flex items-center gap-2\">\n      {/* tu texto y botones de edici√≥n de comanda */}\n      ...\n    </div>\n  )}\n\n  <button\n    className=\"btn-base btn-secundario\"\n    onClick={descargarRegistro}\n  >\n    Descargar Registro\n  </button>\n\n  <button\n    className=\"btn-base btn-secundario\"\n    onClick={imprimirUltimoTicket}\n  >\n    Imprimir Ticket Anterior\n  </button>\n\n  <button\n    className=\"btn-base btn-secundario\"\n    onClick={reiniciarRegistro}\n  >\n    Reiniciar Registro\n  </button>\n\n  <button\n    className=\"btn-base btn-secundario\"\n    onClick={abrirResumenVentas}\n  >\n    Resumen por producto\n  </button>\n\n  <button\n    className=\"btn-base btn-secundario\"\n    onClick={abrirResumenPorVenta}\n  >\n    Resumen por venta\n  </button>\n\n  <button\n    className=\"btn-base btn-secundario\"\n    onClick={abrirCierreConConteo}\n  >\n    Cierre de caja\n  </button>\n</div>\n\n\n        {comandasAbierto && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\n            <div\n              className=\"absolute inset-0 bg-black/50\"\n              onClick={cerrarComandas}\n            />\n            <div className=\"relative z-10 w-[95%] max-w-2xl bg-white rounded-xl shadow-xl border border-gray-200 p-4\">\n              <h3 className=\"text-lg font-semibold text-center\">Comandas</h3>\n\n              <div className=\"mt-2 flex items-center gap-2\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Buscar por fecha (DD-MM-YYYY) o nro sugerido...\"\n                  value={buscaComanda}\n                  onChange={(e) => setBuscaComanda(e.target.value)}\n                  className=\"flex-1 border rounded p-2\"\n                />\n                <button\n                  className=\"px-3 py-2 rounded-md border\"\n                  onClick={() => setBuscaComanda(\"\")}\n                >\n                  Limpiar\n                </button>\n              </div>\n\n              <div className=\"mt-3 max-h-[60vh] overflow-auto divide-y\">\n                {estado.comandas\n                  .filter((c) => {\n                    if (c.estado === \"anulada\") return false;\n                    if (!buscaComanda) return true;\n                    const q = buscaComanda.trim().toLowerCase();\n                    return (\n                      c.fecha.toLowerCase().includes(q) ||\n                      String(c.numeroSugerido).includes(q)\n                    );\n                  })\n                  .sort((a, b) => b.createdAtISO.localeCompare(a.createdAtISO))\n                  .map((c) => {\n                    const total = totalComanda(c);\n                    return (\n                      <div key={c.id} className=\"py-3\">\n                        <div className=\"flex justify-between items-center\">\n                          <div className=\"text-sm\">\n                            <div className=\"font-semibold\">\n                              {c.estado === \"pendiente\"\n                                ? \"üü° Pendiente\"\n                                : \"üü¢ Cobrada\"}\n                            </div>\n                            <div className=\"text-gray-600\">\n                              {c.alias && (\n                                <div className=\"text-gray-900 font-bold\">\n                                  {c.alias}\n                                </div>\n                              )}\n                              {c.fecha} {c.hora} ‚Äî sugerida N¬∞{\" \"}\n                              {c.numeroSugerido}\n                            </div>\n                            <div className=\"text-gray-600\">\n                              √çtems:{\" \"}\n                              {c.lineas.reduce((s, ln) => s + (ln.qty || 1), 0)}{\" \"}\n                              ‚Äî Total aprox: ${fmtAR(total)}\n                            </div>\n                            {c.obs && ( // üëà NUEVO bloque\n                              <div className=\"text-gray-700\">\n                                <b>Obs:</b> {c.obs}\n                              </div>\n                            )}\n                          </div>\n                          <div className=\"flex gap-2\">\n                            {c.estado === \"pendiente\" && (\n                              <>\n                                <button\n                                  className=\"bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-1 px-3 rounded\"\n                                  onClick={() => cargarComanda(c.id)}\n                                  title=\"Cargar al carrito\"\n                                >\n                                  Cargar\n                                </button>\n                                <button\n                                  className=\"bg-green-600 hover:bg-green-700 text-white text-xs font-bold py-1 px-3 rounded\"\n                                  onClick={() => confirmarComanda(c.id)}\n                                  title=\"Cargar y cobrar\"\n                                >\n                                  Confirmar\n                                </button>\n                              </>\n                            )}\n                            <button\n                              className=\"bg-red-600 hover:bg-red-700 text-white text-xs font-bold py-1 px-3 rounded\"\n                              onClick={() => eliminarComanda(c.id)}\n                              title=\"Eliminar\"\n                            >\n                              Eliminar\n                            </button>\n                          </div>\n                        </div>\n\n                        {/* Mini detalle */}\n                        <ul className=\"mt-2 text-xs text-gray-700 list-disc pl-5\">\n                          {c.lineas.slice(0, 4).map((ln) => {\n                            const p = productos.find(\n                              (pp) => pp.id === ln.productoId\n                            );\n                            return (\n                              <li key={ln.uid}>\n                                {ln.qty || 1}√ó{\" \"}\n                                {p?.nombre ?? \"Prod \" + ln.productoId}\n                              </li>\n                            );\n                          })}\n                          {c.lineas.length > 4 && (\n                            <li>‚Ä¶ y {c.lineas.length - 4} m√°s</li>\n                          )}\n                        </ul>\n                      </div>\n                    );\n                  })}\n              </div>\n\n              <div className=\"mt-4 flex justify-end\">\n                <button\n                  className=\"px-3 py-2 rounded-md border\"\n                  onClick={cerrarComandas}\n                >\n                  Cerrar\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* ========= MODAL COBRO ========= */}\n{cobroAbierto && (\n  <div\n    style={{\n      fontFamily: \"Montserrat, sans-serif\",\n      position: \"fixed\",\n      inset: 0,\n      backgroundColor: \"rgba(0,0,0,0.5)\",\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      zIndex: 9999,\n      padding: 10,\n    }}\n    onClick={cancelarCobro} /* clic afuera cierra */\n  >\n    <div\n      onClick={(e) => e.stopPropagation()} /* evita que cierre al clicar adentro */\n      style={{\n        fontFamily: \"Montserrat, sans-serif\",\n        background: \"white\",\n        width: \"100%\",\n        maxWidth: \"420px\",\n        borderRadius: \"10px\",\n        border: \"1px solid #d90f0fff\",\n        padding: \"16px\",\n        boxShadow: \"0 4px 12px rgba(0,0,0,0.3)\",\n      }}\n    >\n      <h3 style={{ fontSize: 18, fontWeight: \"bold\", textAlign: \"center\" }}>\n        Cobro de la venta\n      </h3>\n\n      <div\n        style={{\n          fontFamily: \"Montserrat, sans-serif\",\n          fontSize: 18,\n          color: \"#ff2727\",\n          textAlign: \"center\",\n          marginTop: 4,\n          marginBottom: 8,\n        }}\n      >\n        TOTAL A COBRAR: <b>${fmtAR(calcularTotal())}</b>\n      </div>\n\n      <div style={{ marginTop: 8 }}>\n        {MEDIOS.map((m) => (\n          <div\n            key={m}\n            style={{\n              fontFamily: \"Montserrat, sans-serif\",\n              color: \"#26608e\",\n              display: \"flex\",\n              gap: 8,\n              alignItems: \"center\",\n              marginBottom: 6,\n            }}\n          >\n            <label style={{ width: 80 }}>{m}</label>\n            <input\n              type=\"number\"\n              min={0}\n              step=\"1\"\n              inputMode=\"numeric\"\n              style={{\n                flex: 1,\n                padding: 6,\n                borderRadius: 4,\n                border: \"1px solid #a73332\",\n              }}\n              value={pagosDraft[m] ? pagosDraft[m] : \"\"}\n              onChange={(e) =>\n                setPagosDraft((prev) => ({\n                  ...prev,\n                  [m]: Number(e.target.value) || 0,\n                }))\n              }\n            />\n          </div>\n        ))}\n      </div>\n            {/* Resumen din√°mico */}\n      {(() => {\n        const total = calcularTotal();\n        const sumatoria = sumaPagos(pagosDraft);\n        const diferencia = total - sumatoria;      // >0 falta, <0 sobra\n        const pendiente = Math.max(diferencia, 0); // lo que falta cobrar\n        const vueltoUI = Math.max(-diferencia, 0); // lo que hay que devolver\n\n        return (\n          <div\n            style={{\n              marginTop: 10,\n              paddingTop: 8,\n              borderTop: \"1px solid #cd2c2cff\",\n              fontSize: 14,\n            }}\n          >\n            <div\n              style={{\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                marginBottom: 2,\n              }}\n            >\n              <span>Sumatoria</span>\n              <span>${fmtAR(sumatoria)}</span>\n            </div>\n\n            <div\n              style={{\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                marginBottom: 2,\n                color: pendiente > 0 ? \"#b91c1c\" : \"#555\",\n                fontWeight: pendiente > 0 ? \"bold\" : \"normal\",\n              }}\n            >\n              <span>Pendiente</span>\n              <span>${fmtAR(pendiente)}</span>\n            </div>\n\n            <div\n              style={{\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                color: vueltoUI > 0 ? \"#1d4ed8\" : \"#555\",\n                fontWeight: vueltoUI > 0 ? \"bold\" : \"normal\",\n              }}\n            >\n              <span>Vuelto</span>\n              <span>${fmtAR(vueltoUI)}</span>\n            </div>\n          </div>\n        );\n      })()}\n\n\n       {/* Botones (modal de cobro) */}\n      <div\n        style={{\n          marginTop: 12,\n          display: \"flex\",\n          justifyContent: \"flex-end\",\n          gap: 8,\n          flexWrap: \"wrap\",\n        }}\n      >\n        <Boton\n          bg=\"#e9e1d7\"\n          color=\"#12860c\"\n          hoverBg=\"#12860c\"\n          hoverColor=\"#e9e1d7\"\n          onClick={() => setPagosDraft({ ...estadoVacioPagos })}\n        >\n          Borrar\n        </Boton>\n\n        <Boton\n          bg=\"#e9e1d7\"\n          color=\"#12860c\"\n          hoverBg=\"#12860c\"\n          hoverColor=\"#e9e1d7\"\n          onClick={() =>\n            setPagosDraft({\n              ...estadoVacioPagos,\n              Efectivo: calcularTotal(),\n            })\n          }\n        >\n          Efectivo = Total\n        </Boton>\n\n        <Boton\n          bg=\"#e9e1d7\"\n          color=\"#12860c\"\n          hoverBg=\"#12860c\"\n          hoverColor=\"#e9e1d7\"\n          onClick={cancelarCobro}\n        >\n          Cancelar\n        </Boton>\n\n        <Boton\n          bg=\"#e9e1d7\"\n          color=\"#12860c\"\n          hoverBg=\"#12860c\"\n          hoverColor=\"#e9e1d7\"\n          onClick={confirmarCobro}\n        >\n          Confirmar\n        </Boton>\n      </div>\n    </div>\n  </div>\n)}\n\n{/* ========= MODAL CIERRE CON CONTEO (MISMO FORMATO QUE COBRO) ========= */}\n{cierreAbierto && resumenCorte && (\n  <div\n    style={{\n      fontFamily: \"Montserrat, sans-serif\",\n      position: \"fixed\",\n      inset: 0,\n      backgroundColor: \"rgba(0,0,0,0.5)\",\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      zIndex: 9999,\n      padding: 10,\n    }}\n    onClick={() => {\n      setCierreAbierto(false);\n      setResumenCorte(null);\n    }} // clic afuera cierra\n  >\n    <div\n      onClick={(e) => e.stopPropagation()} // evita cerrar al clicar adentro\n      style={{\n        fontFamily: \"Montserrat, sans-serif\",\n        background: \"white\",\n        width: \"100%\",\n        maxWidth: \"720px\",\n        borderRadius: \"10px\",\n        border: \"1px solid #d90f0fff\",\n        padding: \"16px\",\n        boxShadow: \"0 4px 12px rgba(0,0,0,0.3)\",\n      }}\n    >\n      <h3 style={{ fontSize: 18, fontWeight: \"bold\", textAlign: \"center\" }}>\n        Cierre de caja con conteo\n      </h3>\n\n      <div\n        style={{\n          fontSize: 12,\n          color: \"#555\",\n          textAlign: \"center\",\n          marginTop: 4,\n          marginBottom: 8,\n        }}\n      >\n        Desde: <b>{resumenCorte.desdeISO}</b> ‚Äî Hasta:{\" \"}\n        <b>{resumenCorte.hastaISO}</b> ‚Äî Tickets:{\" \"}\n        <b>{resumenCorte.cantidadVentas}</b>\n      </div>\n\n      {/* Totales del sistema */}\n      <div style={{ marginTop: 12 }}>\n        <h4 style={{ fontWeight: 700, fontSize: 14 }}>Totales del sistema</h4>\n\n        <div\n          style={{\n            display: \"grid\",\n            gridTemplateColumns: \"repeat(auto-fit, minmax(170px, 1fr))\",\n            gap: 8,\n            marginTop: 6,\n            fontSize: 14,\n          }}\n        >\n          {mediosPagoLista.map((mp) => (\n            <div\n              key={mp}\n              style={{\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                border: \"1px solid #ddd\",\n                borderRadius: 6,\n                padding: \"6px 8px\",\n              }}\n            >\n              <span>{mp}</span>\n              <span>${fmtAR(resumenCorte.totalesPorMedio[mp] ?? 0)}</span>\n            </div>\n          ))}\n        </div>\n\n        <div\n          style={{\n            marginTop: 8,\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            fontWeight: 700,\n            fontSize: 14,\n          }}\n        >\n          <span>Total general</span>\n          <span>${fmtAR(resumenCorte.totalGeneral)}</span>\n        </div>\n      </div>\n\n      {/* Efectivo */}\n      <div style={{ marginTop: 16 }}>\n        <h4 style={{ fontWeight: 700, fontSize: 14 }}>\n          Efectivo (cantidades de billetes)\n        </h4>\n\n        <div\n          style={{\n            display: \"grid\",\n            gridTemplateColumns: \"repeat(auto-fit, minmax(120px, 1fr))\",\n            gap: 8,\n            marginTop: 6,\n            fontSize: 14,\n          }}\n        >\n          {billetesDefs.map(({ k, l }) => (\n            <label key={k} style={{ fontSize: 14 }}>\n              <span style={{ marginRight: 6 }}>{l}</span>\n              <input\n                type=\"number\"\n                min={0}\n                inputMode=\"numeric\"\n                style={{\n                  width: \"100%\",\n                  padding: 6,\n                  borderRadius: 4,\n                  border: \"1px solid #a73332\",\n                  marginTop: 4,\n                }}\n                value={billetes[k] ?? \"\"}\n                onChange={(e) =>\n                  setBilletes((prev) => ({\n                    ...prev,\n                    [k]: e.target.value,\n                  }))\n                }\n                placeholder=\"cant.\"\n              />\n            </label>\n          ))}\n        </div>\n\n        <div\n          style={{\n            marginTop: 8,\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            fontSize: 14,\n          }}\n        >\n          <span>Total efectivo contado</span>\n          <span style={{ fontWeight: 700 }}>\n            ${fmtAR(totalEfectivoContado())}\n          </span>\n        </div>\n      </div>\n\n      {/* Cuentas */}\n      <div style={{ marginTop: 16 }}>\n        <h4 style={{ fontWeight: 700, fontSize: 14 }}>Cuentas</h4>\n\n        <div\n          style={{\n            display: \"grid\",\n            gridTemplateColumns: \"repeat(auto-fit, minmax(160px, 1fr))\",\n            gap: 8,\n            marginTop: 6,\n            fontSize: 14,\n          }}\n        >\n          {cuentasDefs.map(({ k, label }) => (\n  <label key={k} style={{ fontSize: 14 }}>\n    <span style={{ marginRight: 6 }}>{label}</span>\n    <input\n      type=\"number\"\n      min={0}\n      inputMode=\"numeric\"\n      style={{\n        width: \"100%\",\n        padding: 6,\n        borderRadius: 4,\n        border: \"1px solid #a73332\",\n        marginTop: 4,\n      }}\n      value={cuentas[k] ?? \"\"}\n      onChange={(e) =>\n        setCuentas((prev) => ({\n          ...prev,\n          [k]: e.target.value,\n        }))\n      }\n      placeholder=\"$\"\n    />\n  </label>\n))}\n        </div>\n      </div>\n\n      {/* Resumen global */}\n      <div\n        style={{\n          marginTop: 16,\n          border: \"1px solid #ddd\",\n          borderRadius: 8,\n          padding: 10,\n          fontSize: 14,\n        }}\n      >\n        <h4 style={{ fontWeight: 700, fontSize: 14, marginBottom: 6 }}>\n          Resumen global\n        </h4>\n\n        <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n          <span>Total del sistema</span>\n          <span>${fmtAR(resumenCorte.totalGeneral)}</span>\n        </div>\n\n        <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n          <span>Total contado (Efvo + MP + Cuentas)</span>\n          <span>\n            $\n            {fmtAR(\n              totalEfectivoContado() +\n                Number(cuentas.mp || 0) +\n                totalCuentasBicaMacroContado()\n            )}\n          </span>\n        </div>\n\n        {(() => {\n          const dif =\n            totalEfectivoContado() +\n            Number(cuentas.mp || 0) +\n            totalCuentasBicaMacroContado() -\n            resumenCorte.totalGeneral;\n\n          const color = dif === 0 ? \"#166534\" : \"#991b1b\";\n          return (\n            <div\n              style={{\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                fontWeight: 700,\n                color,\n              }}\n            >\n              <span>Diferencia (contado - sistema)</span>\n              <span>${fmtAR(dif)}</span>\n            </div>\n          );\n        })()}\n      </div>\n\n      {/* Botones (MISMA FILA QUE COBRO) */}\n      <div\n        style={{\n          marginTop: 12,\n          display: \"flex\",\n          justifyContent: \"flex-end\",\n          gap: 8,\n          flexWrap: \"wrap\",\n        }}\n      >\n        <Boton\n          bg=\"#e9e1d7\"\n          color=\"#12860c\"\n          hoverBg=\"#12860c\"\n          hoverColor=\"#e9e1d7\"\n          onClick={() => {\n            setCierreAbierto(false);\n            setResumenCorte(null);\n          }}\n        >\n          Cancelar\n        </Boton>\n\n        <Boton\n          bg=\"#e9e1d7\"\n          color=\"#12860c\"\n          hoverBg=\"#12860c\"\n          hoverColor=\"#e9e1d7\"\n          onClick={confirmarCierreConConteo}\n        >\n          Confirmar y cerrar per√≠odo\n        </Boton>\n      </div>\n    </div>\n  </div>\n)}\n\n{/* ========= MODAL RESUMEN DE VENTA ========= */}\n{resumenVenta && (\n  <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\n    <div\n      className=\"absolute inset-0 bg-black/50\"\n      onClick={() => setResumenVenta(null)}\n    />\n    <div className=\"relative z-10 w-[95%] max-w-md bg-white rounded-xl shadow-xl border border-gray-500 p-4\">\n      <h3 className=\"text-lg font-semibold text-center mb-2\">\n        Venta N¬∞ {resumenVenta.numeroVenta}\n      </h3>\n\n      {/* Fecha / hora */}\n      {resumenVenta.ventas.length > 0 && (\n        <div className=\"text-xs text-gray-600 text-center mb-2\">\n          <div>\n            Fecha: <b>{resumenVenta.ventas[0].fecha}</b> ‚Äî Hora:{\" \"}\n            <b>{resumenVenta.ventas[0].hora}</b>\n          </div>\n          <div>\n            Lugar de consumo:{\" \"}\n            <b>{resumenVenta.ventas[0].lugarConsumo}</b>\n          </div>\n        </div>\n      )}\n\n      {/* Productos */}\n      <div className=\"mt-2 border-t pt-2\">\n        <h4 className=\"text-sm font-semibold mb-1\">\n          Detalle de productos\n        </h4>\n        <ul className=\"text-sm space-y-1 max-h-48 overflow-auto\">\n          {resumenVenta.ventas.map((v, idx) => (\n            <li\n              key={idx}\n              className=\"flex flex-col border-b last:border-b-0 pb-1\"\n            >\n              <div className=\"flex justify-between\">\n                <span>\n                  {v.cantidad}√ó {v.producto}\n                </span>\n                <span>${fmtAR(v.cantidad * v.precio)}</span>\n              </div>\n              {v.mensajeTicket && (\n                <span className=\"text-xs text-gray-600\">\n                  &gt; {v.mensajeTicket}\n                </span>\n              )}\n            </li>\n          ))}\n        </ul>\n      </div>\n\n      {/* Totales y pagos */}\n      <div className=\"mt-3 border-t pt-2 text-sm space-y-1\">\n        <div className=\"flex justify-between font-semibold\">\n          <span>Total</span>\n          <span>${fmtAR(resumenVenta.total)}</span>\n        </div>\n\n        {resumenVenta.vuelto > 0 && (\n          <div className=\"flex justify-between text-blue-700 font-semibold\">\n            <span>Vuelto</span>\n            <span>${fmtAR(resumenVenta.vuelto)}</span>\n          </div>\n        )}\n\n        <div className=\"mt-2\">\n          <h4 className=\"text-sm font-semibold mb-1\">Medios de pago</h4>\n          <div className=\"space-y-1\">\n            {MEDIOS.filter(\n              (m) => (resumenVenta.pagos[m] || 0) > 0\n            ).map((m) => (\n              <div\n                key={m}\n                className=\"flex justify-between text-sm\"\n              >\n                <span>{m}</span>\n                <span>${fmtAR(resumenVenta.pagos[m] || 0)}</span>\n              </div>\n            ))}\n\n            {MEDIOS.every(\n              (m) => (resumenVenta.pagos[m] || 0) === 0\n            ) && (\n              <div className=\"text-xs text-gray-500\">\n                (Sin detalle de medios de pago)\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div className=\"mt-4 flex justify-end gap-2\">\n        <button\n          className=\"px-3 py-2 rounded-md border\"\n          onClick={() => setResumenVenta(null)}\n        >\n          Cerrar\n        </button>\n      </div>\n    </div>\n  </div>\n)}\n\n      </div>\n    </>\n  );\n};\n\nexport default Evento14Diciembre;\n","import React, { StrictMode } from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport \"./styles.css\";\n\nimport App from \"./App\";\n\nconst container = document.getElementById(\"root\");\n\nif (container) {\n  const root = createRoot(container);\n  root.render(\n    <StrictMode>\n      <App />\n    </StrictMode>\n  );\n} else {\n  console.error(\"‚ùå No se encontr√≥ el elemento #root en index.html\");\n}\n\n"],"sourceRoot":""}